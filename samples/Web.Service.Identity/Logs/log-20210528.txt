2021-05-28 08:50:49.686 +03:00 [INF] User profile is available. Using 'C:\Users\Max\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2021-05-28 08:50:49.955 +03:00 [INF] Starting service
2021-05-28 08:50:51.252 +03:00 [INF] Now listening on: http://localhost:5000
2021-05-28 08:50:51.254 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2021-05-28 08:50:51.257 +03:00 [INF] Hosting environment: Development
2021-05-28 08:50:51.257 +03:00 [INF] Content root path: C:\work\Github\PlatformFramework\samples\Web.Service.Identity
2021-05-28 08:50:52.536 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-28 08:50:53.282 +03:00 [INF] Executed DbCommand (77ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE ([u].[IsDeleted] <> CAST(1 AS bit)) AND ([u].[IsSystemAccount] = CAST(1 AS bit))
2021-05-28 08:50:53.723 +03:00 [INF] Executed DbCommand (111ms) [Parameters=[@__roleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[RoleId], [t].[RoleCode], [t].[Title], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0], [t0].[EntityDefinitionCode], [t0].[PermissionCode]
FROM (
    SELECT TOP(1) [r].[RoleId], [r].[RoleCode], [r].[Title]
    FROM [Cofoundry].[Role] AS [r]
    WHERE [r].[RoleId] = @__roleId_0
) AS [t]
LEFT JOIN (
    SELECT [r0].[RoleId], [r0].[PermissionId], [p].[PermissionId] AS [PermissionId0], [p].[EntityDefinitionCode], [p].[PermissionCode]
    FROM [Cofoundry].[RolePermission] AS [r0]
    INNER JOIN [Cofoundry].[Permission] AS [p] ON [r0].[PermissionId] = [p].[PermissionId]
) AS [t0] ON [t].[RoleId] = [t0].[RoleId]
ORDER BY [t].[RoleId], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0]
2021-05-28 08:50:53.834 +03:00 [INF] Executed DbCommand (65ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [e].[EntityDefinitionCode], [e].[Name]
FROM [Cofoundry].[EntityDefinition] AS [e]
2021-05-28 08:50:53.900 +03:00 [INF] Executed DbCommand (41ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[PermissionId], [p].[EntityDefinitionCode], [p].[PermissionCode]
FROM [Cofoundry].[Permission] AS [p]
2021-05-28 08:50:54.018 +03:00 [INF] Executed DbCommand (63ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[RoleId], [r].[RoleCode], [r].[Title], [t].[RoleId], [t].[PermissionId], [t].[PermissionId0], [t].[EntityDefinitionCode], [t].[PermissionCode]
FROM [Cofoundry].[Role] AS [r]
LEFT JOIN (
    SELECT [r0].[RoleId], [r0].[PermissionId], [p].[PermissionId] AS [PermissionId0], [p].[EntityDefinitionCode], [p].[PermissionCode]
    FROM [Cofoundry].[RolePermission] AS [r0]
    INNER JOIN [Cofoundry].[Permission] AS [p] ON [r0].[PermissionId] = [p].[PermissionId]
) AS [t] ON [r].[RoleId] = [t].[RoleId]
ORDER BY [r].[RoleId], [t].[RoleId], [t].[PermissionId], [t].[PermissionId0]
2021-05-28 08:51:02.294 +03:00 [INF] Executed DbCommand (90ms) [Parameters=[@__distributedLock_LockingId_0='?' (DbType = Guid), @__distributedLock_DistributedLockId_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [d].[DistributedLockId], [d].[ExpiryDate], [d].[LockDate], [d].[LockingId], [d].[Name]
FROM [Cofoundry].[DistributedLock] AS [d]
WHERE ([d].[LockingId] = @__distributedLock_LockingId_0) AND ([d].[DistributedLockId] = @__distributedLock_DistributedLockId_1)
2021-05-28 08:51:02.612 +03:00 [INF] Executed DbCommand (105ms) [Parameters=[@p3='?' (Size = 450), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Cofoundry].[DistributedLock] SET [ExpiryDate] = @p0, [LockDate] = @p1, [LockingId] = @p2
WHERE [DistributedLockId] = @p3;
SELECT @@ROWCOUNT;
2021-05-28 08:51:02.673 +03:00 [INF] Process completed
2021-05-28 08:52:46.361 +03:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/getAll - -
2021-05-28 08:52:46.385 +03:00 [INF] CORS policy execution successful.
2021-05-28 08:52:46.422 +03:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/getAll - - - 204 - - 67.0084ms
2021-05-28 08:52:46.466 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/usersApi/getAll application/json 31
2021-05-28 08:52:46.468 +03:00 [INF] CORS policy execution successful.
2021-05-28 08:52:46.625 +03:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2021-05-28 08:52:46.646 +03:00 [INF] AuthenticationScheme: Cookies was challenged.
2021-05-28 08:52:46.652 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/usersApi/getAll application/json 31 - 401 0 - 185.8964ms
2021-05-28 09:36:51.381 +03:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/auth/login - -
2021-05-28 09:36:51.403 +03:00 [INF] CORS policy execution successful.
2021-05-28 09:36:51.414 +03:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/api/auth/login - - - 204 - - 35.8009ms
2021-05-28 09:36:51.458 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/auth/login application/json 67
2021-05-28 09:36:51.460 +03:00 [INF] CORS policy execution successful.
2021-05-28 09:36:51.571 +03:00 [INF] Executing endpoint 'Cofoundry.Web.Admin.AuthController.Login (Dot.Web.Admin)'
2021-05-28 09:36:51.723 +03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] Login(Cofoundry.Web.Identity.LoginViewModel) on controller Cofoundry.Web.Admin.AuthController (Dot.Web.Admin).
2021-05-28 09:36:52.064 +03:00 [INF] Executing action method Cofoundry.Web.Admin.AuthController.Login (Dot.Web.Admin) - Validation state: "Valid"
2021-05-28 09:36:52.209 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-28 09:36:52.346 +03:00 [INF] Executed DbCommand (72ms) [Parameters=[@__query_Username_0='?' (Size = 150)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username]
FROM [Cofoundry].[User] AS [u]
WHERE (([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit))) AND ([u].[Username] = @__query_Username_0)
2021-05-28 09:36:52.478 +03:00 [INF] AuthenticationScheme: Cookies signed out.
2021-05-28 09:36:52.498 +03:00 [INF] AuthenticationScheme: Cookies signed in.
2021-05-28 09:36:52.667 +03:00 [INF] Executed DbCommand (147ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE (([u].[UserId] = @__id_0) AND ([u].[IsDeleted] <> CAST(1 AS bit))) AND (([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit)))
2021-05-28 09:36:52.778 +03:00 [INF] Executed DbCommand (93ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username]
FROM [Cofoundry].[User] AS [u]
WHERE (([u].[UserId] = @__id_0) AND ([u].[IsDeleted] <> CAST(1 AS bit))) AND (([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit)))
2021-05-28 09:36:52.901 +03:00 [INF] Executed DbCommand (101ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Cofoundry].[User] SET [LastLoginDate] = @p0, [PreviousLoginDate] = @p1
WHERE [UserId] = @p2;
SELECT @@ROWCOUNT;
2021-05-28 09:36:52.929 +03:00 [INF] Executed action method Cofoundry.Web.Admin.AuthController.Login (Dot.Web.Admin), returned result Microsoft.AspNetCore.Mvc.OkResult in 851.4603ms.
2021-05-28 09:36:52.951 +03:00 [INF] Executing HttpStatusCodeResult, setting HTTP status code 200
2021-05-28 09:36:52.969 +03:00 [INF] Executed action Cofoundry.Web.Admin.AuthController.Login (Dot.Web.Admin) in 1230.8019ms
2021-05-28 09:36:52.973 +03:00 [INF] Executed endpoint 'Cofoundry.Web.Admin.AuthController.Login (Dot.Web.Admin)'
2021-05-28 09:36:52.982 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/auth/login application/json 67 - 200 0 - 1523.9141ms
2021-05-28 09:36:55.379 +03:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/getAll - -
2021-05-28 09:36:55.381 +03:00 [INF] CORS policy execution successful.
2021-05-28 09:36:55.381 +03:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/getAll - - - 204 - - 2.1765ms
2021-05-28 09:36:55.388 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/usersApi/getAll application/json 31
2021-05-28 09:36:55.389 +03:00 [INF] CORS policy execution successful.
2021-05-28 09:36:55.401 +03:00 [INF] Authorization was successful.
2021-05-28 09:36:55.403 +03:00 [INF] Executing endpoint 'Cofoundry.Web.Admin.UsersApiController.GetAll (Dot.Web.Admin)'
2021-05-28 09:36:55.420 +03:00 [INF] Route matched with {action = "GetAll", controller = "UsersApi"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(Cofoundry.Domain.SearchUserSummariesQuery) on controller Cofoundry.Web.Admin.UsersApiController (Dot.Web.Admin).
2021-05-28 09:36:55.460 +03:00 [INF] Executing action method Cofoundry.Web.Admin.UsersApiController.GetAll (Dot.Web.Admin) - Validation state: "Valid"
2021-05-28 09:36:55.473 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-28 09:36:55.573 +03:00 [INF] Executed DbCommand (93ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE (([u].[UserId] = @__id_0) AND ([u].[IsDeleted] <> CAST(1 AS bit))) AND (([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit)))
2021-05-28 09:36:55.704 +03:00 [INF] Executed DbCommand (119ms) [Parameters=[@__roleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[RoleId], [t].[RoleCode], [t].[Title], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0], [t0].[EntityDefinitionCode], [t0].[PermissionCode]
FROM (
    SELECT TOP(1) [r].[RoleId], [r].[RoleCode], [r].[Title]
    FROM [Cofoundry].[Role] AS [r]
    WHERE [r].[RoleId] = @__roleId_0
) AS [t]
LEFT JOIN (
    SELECT [r0].[RoleId], [r0].[PermissionId], [p].[PermissionId] AS [PermissionId0], [p].[EntityDefinitionCode], [p].[PermissionCode]
    FROM [Cofoundry].[RolePermission] AS [r0]
    INNER JOIN [Cofoundry].[Permission] AS [p] ON [r0].[PermissionId] = [p].[PermissionId]
) AS [t0] ON [t].[RoleId] = [t0].[RoleId]
ORDER BY [t].[RoleId], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0]
2021-05-28 09:36:55.878 +03:00 [INF] Executed DbCommand (111ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Cofoundry].[User] AS [u]
WHERE ([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit))
2021-05-28 09:36:56.087 +03:00 [INF] Executed DbCommand (106ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[UserId], [t].[CreateDate], [t].[CreatorId], [t].[Email], [t].[FirstName], [t].[IsDeleted], [t].[IsEmailConfirmed], [t].[IsSystemAccount], [t].[LastLoginDate], [t].[LastName], [t].[LastPasswordChangeDate], [t].[Password], [t].[PreviousLoginDate], [t].[RequirePasswordChange], [t].[RoleId], [t].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM (
    SELECT [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username]
    FROM [Cofoundry].[User] AS [u]
    WHERE ([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit))
    ORDER BY [u].[LastName]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t]
INNER JOIN [Cofoundry].[Role] AS [r] ON [t].[RoleId] = [r].[RoleId]
ORDER BY [t].[LastName]
2021-05-28 09:36:56.101 +03:00 [INF] Executed action method Cofoundry.Web.Admin.UsersApiController.GetAll (Dot.Web.Admin), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 640.0644ms.
2021-05-28 09:36:56.119 +03:00 [INF] Executing OkObjectResult, writing value of type 'Cofoundry.Domain.PagedQueryResult`1[[Cofoundry.Domain.UserSummary, Dot.Core, Version=0.7.0.0, Culture=neutral, PublicKeyToken=null]]'.
2021-05-28 09:36:56.245 +03:00 [INF] Executed action Cofoundry.Web.Admin.UsersApiController.GetAll (Dot.Web.Admin) in 823.3162ms
2021-05-28 09:36:56.246 +03:00 [INF] Executed endpoint 'Cofoundry.Web.Admin.UsersApiController.GetAll (Dot.Web.Admin)'
2021-05-28 09:36:56.249 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/usersApi/getAll application/json 31 - 200 - application/json;+charset=utf-8 861.3342ms
2021-05-28 09:36:58.495 +03:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/rolesApi/getAll - -
2021-05-28 09:36:58.496 +03:00 [INF] CORS policy execution successful.
2021-05-28 09:36:58.496 +03:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/api/rolesApi/getAll - - - 204 - - 1.1783ms
2021-05-28 09:36:58.501 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/rolesApi/getAll application/json 31
2021-05-28 09:36:58.502 +03:00 [INF] CORS policy execution successful.
2021-05-28 09:36:58.504 +03:00 [INF] Authorization was successful.
2021-05-28 09:36:58.504 +03:00 [INF] Executing endpoint 'Cofoundry.Web.Admin.RolesApiController.GetAll (Dot.Web.Admin)'
2021-05-28 09:36:58.510 +03:00 [INF] Route matched with {action = "GetAll", controller = "RolesApi"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(Cofoundry.Domain.SearchRolesQuery) on controller Cofoundry.Web.Admin.RolesApiController (Dot.Web.Admin).
2021-05-28 09:36:58.549 +03:00 [INF] Executing action method Cofoundry.Web.Admin.RolesApiController.GetAll (Dot.Web.Admin) - Validation state: "Valid"
2021-05-28 09:36:58.554 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-28 09:36:58.644 +03:00 [INF] Executed DbCommand (88ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE (([u].[UserId] = @__id_0) AND ([u].[IsDeleted] <> CAST(1 AS bit))) AND (([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit)))
2021-05-28 09:36:58.770 +03:00 [INF] Executed DbCommand (110ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Cofoundry].[Role] AS [r]
2021-05-28 09:36:58.840 +03:00 [INF] Executed DbCommand (61ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[Role] AS [r]
ORDER BY [r].[Title]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
2021-05-28 09:36:58.843 +03:00 [INF] Executed action method Cofoundry.Web.Admin.RolesApiController.GetAll (Dot.Web.Admin), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 291.6677ms.
2021-05-28 09:36:58.845 +03:00 [INF] Executing OkObjectResult, writing value of type 'Cofoundry.Domain.PagedQueryResult`1[[Cofoundry.Domain.RoleMicroSummary, Dot.Core, Version=0.7.0.0, Culture=neutral, PublicKeyToken=null]]'.
2021-05-28 09:36:58.854 +03:00 [INF] Executed action Cofoundry.Web.Admin.RolesApiController.GetAll (Dot.Web.Admin) in 342.7551ms
2021-05-28 09:36:58.858 +03:00 [INF] Executed endpoint 'Cofoundry.Web.Admin.RolesApiController.GetAll (Dot.Web.Admin)'
2021-05-28 09:36:58.858 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/rolesApi/getAll application/json 31 - 200 - application/json;+charset=utf-8 357.0589ms
2021-05-28 09:37:00.318 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/usersApi/getAll application/json 31
2021-05-28 09:37:00.322 +03:00 [INF] CORS policy execution successful.
2021-05-28 09:37:00.324 +03:00 [INF] Authorization was successful.
2021-05-28 09:37:00.325 +03:00 [INF] Executing endpoint 'Cofoundry.Web.Admin.UsersApiController.GetAll (Dot.Web.Admin)'
2021-05-28 09:37:00.327 +03:00 [INF] Route matched with {action = "GetAll", controller = "UsersApi"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(Cofoundry.Domain.SearchUserSummariesQuery) on controller Cofoundry.Web.Admin.UsersApiController (Dot.Web.Admin).
2021-05-28 09:37:00.376 +03:00 [INF] Executing action method Cofoundry.Web.Admin.UsersApiController.GetAll (Dot.Web.Admin) - Validation state: "Valid"
2021-05-28 09:37:00.384 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-28 09:37:00.456 +03:00 [INF] Executed DbCommand (67ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE (([u].[UserId] = @__id_0) AND ([u].[IsDeleted] <> CAST(1 AS bit))) AND (([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit)))
2021-05-28 09:37:00.601 +03:00 [INF] Executed DbCommand (139ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Cofoundry].[User] AS [u]
WHERE ([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit))
2021-05-28 09:37:00.745 +03:00 [INF] Executed DbCommand (100ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[UserId], [t].[CreateDate], [t].[CreatorId], [t].[Email], [t].[FirstName], [t].[IsDeleted], [t].[IsEmailConfirmed], [t].[IsSystemAccount], [t].[LastLoginDate], [t].[LastName], [t].[LastPasswordChangeDate], [t].[Password], [t].[PreviousLoginDate], [t].[RequirePasswordChange], [t].[RoleId], [t].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM (
    SELECT [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username]
    FROM [Cofoundry].[User] AS [u]
    WHERE ([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit))
    ORDER BY [u].[LastName]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t]
INNER JOIN [Cofoundry].[Role] AS [r] ON [t].[RoleId] = [r].[RoleId]
ORDER BY [t].[LastName]
2021-05-28 09:37:00.751 +03:00 [INF] Executed action method Cofoundry.Web.Admin.UsersApiController.GetAll (Dot.Web.Admin), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 367.3468ms.
2021-05-28 09:37:00.752 +03:00 [INF] Executing OkObjectResult, writing value of type 'Cofoundry.Domain.PagedQueryResult`1[[Cofoundry.Domain.UserSummary, Dot.Core, Version=0.7.0.0, Culture=neutral, PublicKeyToken=null]]'.
2021-05-28 09:37:00.754 +03:00 [INF] Executed action Cofoundry.Web.Admin.UsersApiController.GetAll (Dot.Web.Admin) in 424.2788ms
2021-05-28 09:37:00.761 +03:00 [INF] Executed endpoint 'Cofoundry.Web.Admin.UsersApiController.GetAll (Dot.Web.Admin)'
2021-05-28 09:37:00.763 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/usersApi/getAll application/json 31 - 200 - application/json;+charset=utf-8 444.4115ms
2021-05-28 09:37:20.078 +03:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/getAll - -
2021-05-28 09:37:20.080 +03:00 [INF] CORS policy execution successful.
2021-05-28 09:37:20.081 +03:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/getAll - - - 204 - - 3.0221ms
2021-05-28 09:37:20.101 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/usersApi/getAll application/json 31
2021-05-28 09:37:20.102 +03:00 [INF] CORS policy execution successful.
2021-05-28 09:37:20.102 +03:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2021-05-28 09:37:20.103 +03:00 [INF] AuthenticationScheme: Cookies was challenged.
2021-05-28 09:37:20.105 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/usersApi/getAll application/json 31 - 401 0 - 3.6517ms
2021-05-28 09:37:28.379 +03:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/auth/login - -
2021-05-28 09:37:28.380 +03:00 [INF] CORS policy execution successful.
2021-05-28 09:37:28.381 +03:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/api/auth/login - - - 204 - - 1.4355ms
2021-05-28 09:37:28.386 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/auth/login application/json 67
2021-05-28 09:37:28.388 +03:00 [INF] CORS policy execution successful.
2021-05-28 09:37:28.392 +03:00 [INF] Executing endpoint 'Cofoundry.Web.Admin.AuthController.Login (Dot.Web.Admin)'
2021-05-28 09:37:28.394 +03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] Login(Cofoundry.Web.Identity.LoginViewModel) on controller Cofoundry.Web.Admin.AuthController (Dot.Web.Admin).
2021-05-28 09:37:28.446 +03:00 [INF] Executing action method Cofoundry.Web.Admin.AuthController.Login (Dot.Web.Admin) - Validation state: "Valid"
2021-05-28 09:37:28.452 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-28 09:37:28.557 +03:00 [INF] Executed DbCommand (92ms) [Parameters=[@__query_Username_0='?' (Size = 150)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username]
FROM [Cofoundry].[User] AS [u]
WHERE (([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit))) AND ([u].[Username] = @__query_Username_0)
2021-05-28 09:37:28.682 +03:00 [INF] AuthenticationScheme: Cookies signed out.
2021-05-28 09:37:28.684 +03:00 [INF] AuthenticationScheme: Cookies signed in.
2021-05-28 09:37:28.810 +03:00 [INF] Executed DbCommand (124ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE (([u].[UserId] = @__id_0) AND ([u].[IsDeleted] <> CAST(1 AS bit))) AND (([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit)))
2021-05-28 09:37:28.887 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username]
FROM [Cofoundry].[User] AS [u]
WHERE (([u].[UserId] = @__id_0) AND ([u].[IsDeleted] <> CAST(1 AS bit))) AND (([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit)))
2021-05-28 09:37:28.956 +03:00 [INF] Executed DbCommand (64ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Cofoundry].[User] SET [LastLoginDate] = @p0, [PreviousLoginDate] = @p1
WHERE [UserId] = @p2;
SELECT @@ROWCOUNT;
2021-05-28 09:37:28.969 +03:00 [INF] Executed action method Cofoundry.Web.Admin.AuthController.Login (Dot.Web.Admin), returned result Microsoft.AspNetCore.Mvc.OkResult in 517.8783ms.
2021-05-28 09:37:28.970 +03:00 [INF] Executing HttpStatusCodeResult, setting HTTP status code 200
2021-05-28 09:37:28.970 +03:00 [INF] Executed action Cofoundry.Web.Admin.AuthController.Login (Dot.Web.Admin) in 574.5842ms
2021-05-28 09:37:28.971 +03:00 [INF] Executed endpoint 'Cofoundry.Web.Admin.AuthController.Login (Dot.Web.Admin)'
2021-05-28 09:37:28.972 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/auth/login application/json 67 - 200 0 - 586.5067ms
2021-05-28 09:37:32.875 +03:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/getAll - -
2021-05-28 09:37:32.878 +03:00 [INF] CORS policy execution successful.
2021-05-28 09:37:32.886 +03:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/getAll - - - 204 - - 10.7664ms
2021-05-28 09:37:32.890 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/usersApi/getAll application/json 31
2021-05-28 09:37:32.892 +03:00 [INF] CORS policy execution successful.
2021-05-28 09:37:32.892 +03:00 [INF] Authorization was successful.
2021-05-28 09:37:32.893 +03:00 [INF] Executing endpoint 'Cofoundry.Web.Admin.UsersApiController.GetAll (Dot.Web.Admin)'
2021-05-28 09:37:32.899 +03:00 [INF] Route matched with {action = "GetAll", controller = "UsersApi"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll(Cofoundry.Domain.SearchUserSummariesQuery) on controller Cofoundry.Web.Admin.UsersApiController (Dot.Web.Admin).
2021-05-28 09:37:32.942 +03:00 [INF] Executing action method Cofoundry.Web.Admin.UsersApiController.GetAll (Dot.Web.Admin) - Validation state: "Valid"
2021-05-28 09:37:32.946 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-28 09:37:33.025 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE (([u].[UserId] = @__id_0) AND ([u].[IsDeleted] <> CAST(1 AS bit))) AND (([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit)))
2021-05-28 09:37:33.101 +03:00 [INF] Executed DbCommand (71ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Cofoundry].[User] AS [u]
WHERE ([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit))
2021-05-28 09:37:33.166 +03:00 [INF] Executed DbCommand (59ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[UserId], [t].[CreateDate], [t].[CreatorId], [t].[Email], [t].[FirstName], [t].[IsDeleted], [t].[IsEmailConfirmed], [t].[IsSystemAccount], [t].[LastLoginDate], [t].[LastName], [t].[LastPasswordChangeDate], [t].[Password], [t].[PreviousLoginDate], [t].[RequirePasswordChange], [t].[RoleId], [t].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM (
    SELECT [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username]
    FROM [Cofoundry].[User] AS [u]
    WHERE ([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit))
    ORDER BY [u].[LastName]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t]
INNER JOIN [Cofoundry].[Role] AS [r] ON [t].[RoleId] = [r].[RoleId]
ORDER BY [t].[LastName]
2021-05-28 09:37:33.174 +03:00 [INF] Executed action method Cofoundry.Web.Admin.UsersApiController.GetAll (Dot.Web.Admin), returned result Microsoft.AspNetCore.Mvc.OkObjectResult in 229.0138ms.
2021-05-28 09:37:33.175 +03:00 [INF] Executing OkObjectResult, writing value of type 'Cofoundry.Domain.PagedQueryResult`1[[Cofoundry.Domain.UserSummary, Dot.Core, Version=0.7.0.0, Culture=neutral, PublicKeyToken=null]]'.
2021-05-28 09:37:33.179 +03:00 [INF] Executed action Cofoundry.Web.Admin.UsersApiController.GetAll (Dot.Web.Admin) in 278.2224ms
2021-05-28 09:37:33.189 +03:00 [INF] Executed endpoint 'Cofoundry.Web.Admin.UsersApiController.GetAll (Dot.Web.Admin)'
2021-05-28 09:37:33.191 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/usersApi/getAll application/json 31 - 200 - application/json;+charset=utf-8 300.5304ms
