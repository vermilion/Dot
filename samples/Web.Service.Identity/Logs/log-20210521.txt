2021-05-21 14:19:48.870 +03:00 [INF] User profile is available. Using 'C:\Users\Max\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2021-05-21 14:19:49.318 +03:00 [INF] Starting service
2021-05-21 14:19:50.836 +03:00 [INF] Now listening on: http://localhost:5000
2021-05-21 14:19:50.837 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2021-05-21 14:19:50.838 +03:00 [INF] Hosting environment: Development
2021-05-21 14:19:50.838 +03:00 [INF] Content root path: C:\work\Github\PlatformFramework\samples\Web.Service.Identity
2021-05-21 14:19:52.710 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-21 14:19:53.779 +03:00 [INF] Executed DbCommand (111ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE ([u].[IsDeleted] <> CAST(1 AS bit)) AND ([u].[IsSystemAccount] = CAST(1 AS bit))
2021-05-21 14:19:54.162 +03:00 [INF] Executed DbCommand (104ms) [Parameters=[@__roleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[RoleId], [t].[RoleCode], [t].[Title], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0], [t0].[EntityDefinitionCode], [t0].[PermissionCode]
FROM (
    SELECT TOP(1) [r].[RoleId], [r].[RoleCode], [r].[Title]
    FROM [Cofoundry].[Role] AS [r]
    WHERE [r].[RoleId] = @__roleId_0
) AS [t]
LEFT JOIN (
    SELECT [r0].[RoleId], [r0].[PermissionId], [p].[PermissionId] AS [PermissionId0], [p].[EntityDefinitionCode], [p].[PermissionCode]
    FROM [Cofoundry].[RolePermission] AS [r0]
    INNER JOIN [Cofoundry].[Permission] AS [p] ON [r0].[PermissionId] = [p].[PermissionId]
) AS [t0] ON [t].[RoleId] = [t0].[RoleId]
ORDER BY [t].[RoleId], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0]
2021-05-21 14:19:54.261 +03:00 [INF] Executed DbCommand (57ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [e].[EntityDefinitionCode], [e].[Name]
FROM [Cofoundry].[EntityDefinition] AS [e]
2021-05-21 14:19:54.351 +03:00 [INF] Executed DbCommand (60ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[PermissionId], [p].[EntityDefinitionCode], [p].[PermissionCode]
FROM [Cofoundry].[Permission] AS [p]
2021-05-21 14:19:54.541 +03:00 [INF] Executed DbCommand (77ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[RoleId], [r].[RoleCode], [r].[Title], [t].[RoleId], [t].[PermissionId], [t].[PermissionId0], [t].[EntityDefinitionCode], [t].[PermissionCode]
FROM [Cofoundry].[Role] AS [r]
LEFT JOIN (
    SELECT [r0].[RoleId], [r0].[PermissionId], [p].[PermissionId] AS [PermissionId0], [p].[EntityDefinitionCode], [p].[PermissionCode]
    FROM [Cofoundry].[RolePermission] AS [r0]
    INNER JOIN [Cofoundry].[Permission] AS [p] ON [r0].[PermissionId] = [p].[PermissionId]
) AS [t] ON [r].[RoleId] = [t].[RoleId]
ORDER BY [r].[RoleId], [t].[RoleId], [t].[PermissionId], [t].[PermissionId0]
2021-05-21 14:19:54.629 +03:00 [INF] "2021-05-21T11:19:53.9405987Z" SUCCESS executing command Cofoundry.Domain.RegisterPermissionsAndRolesCommand. User 1
2021-05-21 14:19:54.718 +03:00 [INF] Process completed
2021-05-21 14:34:12.000 +03:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/getAll - -
2021-05-21 14:34:12.024 +03:00 [INF] CORS policy execution successful.
2021-05-21 14:34:12.225 +03:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/getAll - - - 204 - - 221.5594ms
2021-05-21 14:34:12.334 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/usersApi/getAll application/json 31
2021-05-21 14:34:12.339 +03:00 [INF] CORS policy execution successful.
2021-05-21 14:34:12.506 +03:00 [INF] Authorization was successful.
2021-05-21 14:34:12.510 +03:00 [INF] Executing endpoint 'Cofoundry.Web.Admin.UsersApiController.GetAll (Dot.Web.Admin)'
2021-05-21 14:34:12.594 +03:00 [INF] Route matched with {action = "GetAll", controller = "UsersApi"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.JsonResult] GetAll(Cofoundry.Domain.SearchUserSummariesQuery) on controller Cofoundry.Web.Admin.UsersApiController (Dot.Web.Admin).
2021-05-21 14:34:12.808 +03:00 [INF] Executing action method Cofoundry.Web.Admin.UsersApiController.GetAll (Dot.Web.Admin) - Validation state: "Valid"
2021-05-21 14:34:12.892 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-21 14:34:13.000 +03:00 [INF] Executed DbCommand (51ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE (([u].[UserId] = @__id_0) AND ([u].[IsDeleted] <> CAST(1 AS bit))) AND (([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit)))
2021-05-21 14:34:13.107 +03:00 [INF] Executed DbCommand (92ms) [Parameters=[@__roleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[RoleId], [t].[RoleCode], [t].[Title], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0], [t0].[EntityDefinitionCode], [t0].[PermissionCode]
FROM (
    SELECT TOP(1) [r].[RoleId], [r].[RoleCode], [r].[Title]
    FROM [Cofoundry].[Role] AS [r]
    WHERE [r].[RoleId] = @__roleId_0
) AS [t]
LEFT JOIN (
    SELECT [r0].[RoleId], [r0].[PermissionId], [p].[PermissionId] AS [PermissionId0], [p].[EntityDefinitionCode], [p].[PermissionCode]
    FROM [Cofoundry].[RolePermission] AS [r0]
    INNER JOIN [Cofoundry].[Permission] AS [p] ON [r0].[PermissionId] = [p].[PermissionId]
) AS [t0] ON [t].[RoleId] = [t0].[RoleId]
ORDER BY [t].[RoleId], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0]
2021-05-21 14:34:13.303 +03:00 [INF] Executed DbCommand (130ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Cofoundry].[User] AS [u]
WHERE ([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit))
2021-05-21 14:34:13.391 +03:00 [INF] Executed DbCommand (67ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE ([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit))
ORDER BY [u].[LastName]
2021-05-21 14:34:13.419 +03:00 [INF] Executed action method Cofoundry.Web.Admin.UsersApiController.GetAll (Dot.Web.Admin), returned result Microsoft.AspNetCore.Mvc.JsonResult in 598.0696ms.
2021-05-21 14:34:13.450 +03:00 [INF] Executing JsonResult, writing value of type 'Cofoundry.Domain.PagedQueryResult`1[[Cofoundry.Domain.UserSummary, Dot.Domain, Version=0.7.0.0, Culture=neutral, PublicKeyToken=null]]'.
2021-05-21 14:34:13.979 +03:00 [INF] Executed action Cofoundry.Web.Admin.UsersApiController.GetAll (Dot.Web.Admin) in 1347.814ms
2021-05-21 14:34:13.995 +03:00 [INF] Executed endpoint 'Cofoundry.Web.Admin.UsersApiController.GetAll (Dot.Web.Admin)'
2021-05-21 14:34:14.055 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/usersApi/getAll application/json 31 - 200 - application/json;+charset=utf-8 1721.3104ms
2021-05-21 14:39:42.420 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/rolesApi/getAll - 0
2021-05-21 14:39:42.424 +03:00 [INF] CORS policy execution successful.
2021-05-21 14:39:42.436 +03:00 [INF] Authorization was successful.
2021-05-21 14:39:42.437 +03:00 [INF] Executing endpoint 'Cofoundry.Web.Admin.RolesApiController.GetAll (Dot.Web.Admin)'
2021-05-21 14:39:42.446 +03:00 [INF] Route matched with {action = "GetAll", controller = "RolesApi"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.JsonResult] GetAll(Cofoundry.Domain.SearchRolesQuery) on controller Cofoundry.Web.Admin.RolesApiController (Dot.Web.Admin).
2021-05-21 14:39:42.533 +03:00 [INF] Executing action method Cofoundry.Web.Admin.RolesApiController.GetAll (Dot.Web.Admin) - Validation state: "Valid"
2021-05-21 14:39:42.555 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-21 14:39:42.673 +03:00 [INF] Executed DbCommand (113ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE (([u].[UserId] = @__id_0) AND ([u].[IsDeleted] <> CAST(1 AS bit))) AND (([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit)))
2021-05-21 14:39:42.769 +03:00 [INF] Executed DbCommand (84ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Cofoundry].[Role] AS [r]
2021-05-21 14:39:42.834 +03:00 [INF] Executed DbCommand (58ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[Role] AS [r]
ORDER BY [r].[Title]
2021-05-21 14:39:42.839 +03:00 [INF] Executed action method Cofoundry.Web.Admin.RolesApiController.GetAll (Dot.Web.Admin), returned result Microsoft.AspNetCore.Mvc.JsonResult in 301.7599ms.
2021-05-21 14:39:42.842 +03:00 [INF] Executing JsonResult, writing value of type 'Cofoundry.Domain.PagedQueryResult`1[[Cofoundry.Domain.RoleMicroSummary, Dot.Domain, Version=0.7.0.0, Culture=neutral, PublicKeyToken=null]]'.
2021-05-21 14:39:42.850 +03:00 [INF] Executed action Cofoundry.Web.Admin.RolesApiController.GetAll (Dot.Web.Admin) in 401.7294ms
2021-05-21 14:39:42.853 +03:00 [INF] Executed endpoint 'Cofoundry.Web.Admin.RolesApiController.GetAll (Dot.Web.Admin)'
2021-05-21 14:39:42.855 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/rolesApi/getAll - 0 - 200 - application/json;+charset=utf-8 435.4432ms
2021-05-21 14:41:17.585 +03:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/rolesApi/getAll - -
2021-05-21 14:41:17.594 +03:00 [INF] CORS policy execution successful.
2021-05-21 14:41:17.597 +03:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/api/rolesApi/getAll - - - 204 - - 12.3925ms
2021-05-21 14:41:17.623 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/rolesApi/getAll application/json 25
2021-05-21 14:41:17.629 +03:00 [INF] CORS policy execution successful.
2021-05-21 14:41:17.636 +03:00 [INF] Authorization was successful.
2021-05-21 14:41:17.637 +03:00 [INF] Executing endpoint 'Cofoundry.Web.Admin.RolesApiController.GetAll (Dot.Web.Admin)'
2021-05-21 14:41:17.638 +03:00 [INF] Route matched with {action = "GetAll", controller = "RolesApi"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.JsonResult] GetAll(Cofoundry.Domain.SearchRolesQuery) on controller Cofoundry.Web.Admin.RolesApiController (Dot.Web.Admin).
2021-05-21 14:41:17.680 +03:00 [INF] Executing action method Cofoundry.Web.Admin.RolesApiController.GetAll (Dot.Web.Admin) - Validation state: "Valid"
2021-05-21 14:41:17.683 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-21 14:41:17.753 +03:00 [INF] Executed DbCommand (66ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE (([u].[UserId] = @__id_0) AND ([u].[IsDeleted] <> CAST(1 AS bit))) AND (([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit)))
2021-05-21 14:41:17.846 +03:00 [INF] Executed DbCommand (85ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Cofoundry].[Role] AS [r]
2021-05-21 14:41:17.895 +03:00 [INF] Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[Role] AS [r]
ORDER BY [r].[Title]
2021-05-21 14:41:17.899 +03:00 [INF] Executed action method Cofoundry.Web.Admin.RolesApiController.GetAll (Dot.Web.Admin), returned result Microsoft.AspNetCore.Mvc.JsonResult in 215.9751ms.
2021-05-21 14:41:17.900 +03:00 [INF] Executing JsonResult, writing value of type 'Cofoundry.Domain.PagedQueryResult`1[[Cofoundry.Domain.RoleMicroSummary, Dot.Domain, Version=0.7.0.0, Culture=neutral, PublicKeyToken=null]]'.
2021-05-21 14:41:17.902 +03:00 [INF] Executed action Cofoundry.Web.Admin.RolesApiController.GetAll (Dot.Web.Admin) in 260.0281ms
2021-05-21 14:41:17.903 +03:00 [INF] Executed endpoint 'Cofoundry.Web.Admin.RolesApiController.GetAll (Dot.Web.Admin)'
2021-05-21 14:41:17.910 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/rolesApi/getAll application/json 25 - 200 - application/json;+charset=utf-8 286.9122ms
2021-05-21 14:42:43.667 +03:00 [INF] User profile is available. Using 'C:\Users\Max\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2021-05-21 14:42:43.923 +03:00 [INF] Starting service
2021-05-21 14:42:45.306 +03:00 [INF] Now listening on: http://localhost:5000
2021-05-21 14:42:45.317 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2021-05-21 14:42:45.318 +03:00 [INF] Hosting environment: Development
2021-05-21 14:42:45.318 +03:00 [INF] Content root path: C:\work\Github\PlatformFramework\samples\Web.Service.Identity
2021-05-21 14:42:47.940 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-21 14:42:49.197 +03:00 [INF] Executed DbCommand (145ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE ([u].[IsDeleted] <> CAST(1 AS bit)) AND ([u].[IsSystemAccount] = CAST(1 AS bit))
2021-05-21 14:42:49.895 +03:00 [INF] Executed DbCommand (171ms) [Parameters=[@__roleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[RoleId], [t].[RoleCode], [t].[Title], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0], [t0].[EntityDefinitionCode], [t0].[PermissionCode]
FROM (
    SELECT TOP(1) [r].[RoleId], [r].[RoleCode], [r].[Title]
    FROM [Cofoundry].[Role] AS [r]
    WHERE [r].[RoleId] = @__roleId_0
) AS [t]
LEFT JOIN (
    SELECT [r0].[RoleId], [r0].[PermissionId], [p].[PermissionId] AS [PermissionId0], [p].[EntityDefinitionCode], [p].[PermissionCode]
    FROM [Cofoundry].[RolePermission] AS [r0]
    INNER JOIN [Cofoundry].[Permission] AS [p] ON [r0].[PermissionId] = [p].[PermissionId]
) AS [t0] ON [t].[RoleId] = [t0].[RoleId]
ORDER BY [t].[RoleId], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0]
2021-05-21 14:42:50.029 +03:00 [INF] Executed DbCommand (84ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [e].[EntityDefinitionCode], [e].[Name]
FROM [Cofoundry].[EntityDefinition] AS [e]
2021-05-21 14:42:50.152 +03:00 [INF] Executed DbCommand (67ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[PermissionId], [p].[EntityDefinitionCode], [p].[PermissionCode]
FROM [Cofoundry].[Permission] AS [p]
2021-05-21 14:42:50.286 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[RoleId], [r].[RoleCode], [r].[Title], [t].[RoleId], [t].[PermissionId], [t].[PermissionId0], [t].[EntityDefinitionCode], [t].[PermissionCode]
FROM [Cofoundry].[Role] AS [r]
LEFT JOIN (
    SELECT [r0].[RoleId], [r0].[PermissionId], [p].[PermissionId] AS [PermissionId0], [p].[EntityDefinitionCode], [p].[PermissionCode]
    FROM [Cofoundry].[RolePermission] AS [r0]
    INNER JOIN [Cofoundry].[Permission] AS [p] ON [r0].[PermissionId] = [p].[PermissionId]
) AS [t] ON [r].[RoleId] = [t].[RoleId]
ORDER BY [r].[RoleId], [t].[RoleId], [t].[PermissionId], [t].[PermissionId0]
2021-05-21 14:42:50.411 +03:00 [INF] "2021-05-21T11:42:49.5198283Z" SUCCESS executing command Cofoundry.Domain.RegisterPermissionsAndRolesCommand. User 1
2021-05-21 14:42:50.500 +03:00 [INF] Process completed
2021-05-21 14:44:00.501 +03:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/rolesApi/getAll - -
2021-05-21 14:44:00.528 +03:00 [INF] CORS policy execution successful.
2021-05-21 14:44:00.571 +03:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/api/rolesApi/getAll - - - 204 - - 59.6421ms
2021-05-21 14:44:00.574 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/rolesApi/getAll application/json 25
2021-05-21 14:44:00.591 +03:00 [INF] CORS policy execution successful.
2021-05-21 14:44:00.822 +03:00 [INF] Authorization was successful.
2021-05-21 14:44:00.825 +03:00 [INF] Executing endpoint 'Cofoundry.Web.Admin.RolesApiController.GetAll (Dot.Web.Admin)'
2021-05-21 14:44:00.894 +03:00 [INF] Route matched with {action = "GetAll", controller = "RolesApi"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.JsonResult] GetAll(Cofoundry.Domain.SearchRolesQuery) on controller Cofoundry.Web.Admin.RolesApiController (Dot.Web.Admin).
2021-05-21 14:44:01.198 +03:00 [INF] Executing action method Cofoundry.Web.Admin.RolesApiController.GetAll (Dot.Web.Admin) - Validation state: "Valid"
2021-05-21 14:44:13.647 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-21 14:44:13.789 +03:00 [INF] Executed DbCommand (133ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE (([u].[UserId] = @__id_0) AND ([u].[IsDeleted] <> CAST(1 AS bit))) AND (([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit)))
2021-05-21 14:44:13.890 +03:00 [INF] Executed DbCommand (84ms) [Parameters=[@__roleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[RoleId], [t].[RoleCode], [t].[Title], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0], [t0].[EntityDefinitionCode], [t0].[PermissionCode]
FROM (
    SELECT TOP(1) [r].[RoleId], [r].[RoleCode], [r].[Title]
    FROM [Cofoundry].[Role] AS [r]
    WHERE [r].[RoleId] = @__roleId_0
) AS [t]
LEFT JOIN (
    SELECT [r0].[RoleId], [r0].[PermissionId], [p].[PermissionId] AS [PermissionId0], [p].[EntityDefinitionCode], [p].[PermissionCode]
    FROM [Cofoundry].[RolePermission] AS [r0]
    INNER JOIN [Cofoundry].[Permission] AS [p] ON [r0].[PermissionId] = [p].[PermissionId]
) AS [t0] ON [t].[RoleId] = [t0].[RoleId]
ORDER BY [t].[RoleId], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0]
2021-05-21 14:44:14.036 +03:00 [INF] Executed DbCommand (98ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Cofoundry].[Role] AS [r]
WHERE ([r].[RoleCode] <> 'ANO') OR [r].[RoleCode] IS NULL
2021-05-21 14:44:14.138 +03:00 [INF] Executed DbCommand (78ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[Role] AS [r]
WHERE ([r].[RoleCode] <> 'ANO') OR [r].[RoleCode] IS NULL
ORDER BY [r].[Title]
2021-05-21 14:44:26.108 +03:00 [INF] Executed action method Cofoundry.Web.Admin.RolesApiController.GetAll (Dot.Web.Admin), returned result Microsoft.AspNetCore.Mvc.JsonResult in 24896.9219ms.
2021-05-21 14:44:26.114 +03:00 [INF] Executing JsonResult, writing value of type 'Cofoundry.Domain.PagedQueryResult`1[[Cofoundry.Domain.RoleMicroSummary, Dot.Domain, Version=0.7.0.0, Culture=neutral, PublicKeyToken=null]]'.
2021-05-21 14:44:26.180 +03:00 [INF] Executed action Cofoundry.Web.Admin.RolesApiController.GetAll (Dot.Web.Admin) in 25274.1955ms
2021-05-21 14:44:26.183 +03:00 [INF] Executed endpoint 'Cofoundry.Web.Admin.RolesApiController.GetAll (Dot.Web.Admin)'
2021-05-21 14:44:26.191 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/rolesApi/getAll application/json 25 - 200 - application/json;+charset=utf-8 25617.1003ms
2021-05-21 14:44:56.024 +03:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/add - -
2021-05-21 14:44:56.026 +03:00 [INF] CORS policy execution successful.
2021-05-21 14:44:56.031 +03:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/add - - - 204 - - 6.9040ms
2021-05-21 14:44:56.045 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/usersApi/add application/json 82
2021-05-21 14:44:56.046 +03:00 [INF] CORS policy execution successful.
2021-05-21 14:44:56.089 +03:00 [INF] Authorization was successful.
2021-05-21 14:44:56.090 +03:00 [INF] Executing endpoint 'Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin)'
2021-05-21 14:44:56.096 +03:00 [INF] Route matched with {action = "Add", controller = "UsersApi"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.JsonResult] Add(Cofoundry.Domain.AddUserCommand) on controller Cofoundry.Web.Admin.UsersApiController (Dot.Web.Admin).
2021-05-21 14:44:56.143 +03:00 [INF] Executing action method Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin) - Validation state: "Valid"
2021-05-21 14:45:00.310 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-21 14:45:00.360 +03:00 [INF] Executed DbCommand (45ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE (([u].[UserId] = @__id_0) AND ([u].[IsDeleted] <> CAST(1 AS bit))) AND (([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit)))
2021-05-21 14:45:04.513 +03:00 [INF] Executed DbCommand (66ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CAST(0 AS bit)
2021-05-21 14:45:11.190 +03:00 [INF] Executed DbCommand (40ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[Role] AS [r]
WHERE [r].[RoleId] = @__id_0
2021-05-21 14:45:22.229 +03:00 [ERR] Failed executing DbCommand (71ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (Size = 150), @p3='?' (Size = 32), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTime2), @p8='?' (Size = 32), @p9='?' (DbType = DateTime2), @p10='?' (Size = 4000), @p11='?' (DbType = DateTime2), @p12='?' (DbType = Boolean), @p13='?' (DbType = Int32), @p14='?' (Size = 150)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Cofoundry].[User] ([CreateDate], [CreatorId], [Email], [FirstName], [IsDeleted], [IsEmailConfirmed], [IsSystemAccount], [LastLoginDate], [LastName], [LastPasswordChangeDate], [Password], [PreviousLoginDate], [RequirePasswordChange], [RoleId], [Username])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
SELECT [UserId]
FROM [Cofoundry].[User]
WHERE @@ROWCOUNT = 1 AND [UserId] = scope_identity();
2021-05-21 14:45:22.311 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Cofoundry.Domain.Data.CofoundryDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> System.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Username', table 'Cofoundry.BasicTestSite.Cofoundry.User'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__126_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:444950a8-f33f-4d13-ba0e-6fc932aabd72
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> System.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Username', table 'Cofoundry.BasicTestSite.Cofoundry.User'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__126_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:444950a8-f33f-4d13-ba0e-6fc932aabd72
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-05-21 14:45:22.564 +03:00 [INF] "2021-05-21T11:45:00.3847576Z" FAILED executing command Cofoundry.Domain.AddUserCommand. User 2, Exception 'An error occurred while updating the entries. See the inner exception for details.'
2021-05-21 14:45:22.843 +03:00 [INF] "2021-05-21T11:45:00.3847576Z" FAILED executing command Cofoundry.Domain.AddCofoundryUserCommand. User 2, Exception 'An error occurred while updating the entries. See the inner exception for details.'
2021-05-21 14:45:23.417 +03:00 [INF] Executed action Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin) in 27319.682ms
2021-05-21 14:45:23.419 +03:00 [INF] Executed endpoint 'Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin)'
2021-05-21 14:45:23.422 +03:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> System.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Username', table 'Cofoundry.BasicTestSite.Cofoundry.User'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__126_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:444950a8-f33f-4d13-ba0e-6fc932aabd72
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Cofoundry.Domain.Internal.AddUserCommandHandler.ExecuteAsync(AddUserCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\Domain\Users\Commands\AddUserCommandHandler.cs:line 64
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteCommandAsync[TCommand](TCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 130
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteCommandAsync[TCommand](TCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 135
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteAsync(ICommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 107
   at Cofoundry.Domain.Internal.AddCofoundryUserCommandHandler.ExecuteAsync(AddCofoundryUserCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\Domain\Users\Commands\AddCofoundryUserCommandHandler.cs:line 47
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteCommandAsync[TCommand](TCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 130
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteCommandAsync[TCommand](TCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 135
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteAsync(ICommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 107
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteAsync(ICommand command) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 89
   at Cofoundry.Web.ApiResponseHelper.RunCommandAsync[TCommand](TCommand command) in C:\work\Github\PlatformFramework\src\Cofoundry.Web\Framework\WebApi\ApiResponseHelpers\ApiResponseHelper.cs:line 154
   at Cofoundry.Web.Admin.UsersApiController.Add(AddUserCommand command) in C:\work\Github\PlatformFramework\src\Cofoundry.Web.Admin\Admin\Api\Users\UsersApiController.cs:line 59
   at lambda_method323(Closure , Object )
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.ResponseCompression.ResponseCompressionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2021-05-21 14:45:23.540 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/usersApi/add application/json 82 - 500 - text/plain 27494.5799ms
2021-05-21 14:45:44.709 +03:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/add - -
2021-05-21 14:45:44.711 +03:00 [INF] CORS policy execution successful.
2021-05-21 14:45:44.711 +03:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/add - - - 204 - - 1.5245ms
2021-05-21 14:45:44.733 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/usersApi/add application/json 82
2021-05-21 14:45:44.733 +03:00 [INF] CORS policy execution successful.
2021-05-21 14:45:44.736 +03:00 [INF] Authorization was successful.
2021-05-21 14:45:44.737 +03:00 [INF] Executing endpoint 'Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin)'
2021-05-21 14:45:44.737 +03:00 [INF] Route matched with {action = "Add", controller = "UsersApi"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.JsonResult] Add(Cofoundry.Domain.AddUserCommand) on controller Cofoundry.Web.Admin.UsersApiController (Dot.Web.Admin).
2021-05-21 14:45:44.770 +03:00 [INF] Executing action method Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin) - Validation state: "Valid"
2021-05-21 14:46:59.666 +03:00 [INF] User profile is available. Using 'C:\Users\Max\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2021-05-21 14:46:59.866 +03:00 [INF] Starting service
2021-05-21 14:47:00.972 +03:00 [INF] Now listening on: http://localhost:5000
2021-05-21 14:47:00.973 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2021-05-21 14:47:00.974 +03:00 [INF] Hosting environment: Development
2021-05-21 14:47:00.975 +03:00 [INF] Content root path: C:\work\Github\PlatformFramework\samples\Web.Service.Identity
2021-05-21 14:47:02.714 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-21 14:47:03.439 +03:00 [INF] Executed DbCommand (102ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE ([u].[IsDeleted] <> CAST(1 AS bit)) AND ([u].[IsSystemAccount] = CAST(1 AS bit))
2021-05-21 14:47:03.848 +03:00 [INF] Executed DbCommand (89ms) [Parameters=[@__roleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[RoleId], [t].[RoleCode], [t].[Title], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0], [t0].[EntityDefinitionCode], [t0].[PermissionCode]
FROM (
    SELECT TOP(1) [r].[RoleId], [r].[RoleCode], [r].[Title]
    FROM [Cofoundry].[Role] AS [r]
    WHERE [r].[RoleId] = @__roleId_0
) AS [t]
LEFT JOIN (
    SELECT [r0].[RoleId], [r0].[PermissionId], [p].[PermissionId] AS [PermissionId0], [p].[EntityDefinitionCode], [p].[PermissionCode]
    FROM [Cofoundry].[RolePermission] AS [r0]
    INNER JOIN [Cofoundry].[Permission] AS [p] ON [r0].[PermissionId] = [p].[PermissionId]
) AS [t0] ON [t].[RoleId] = [t0].[RoleId]
ORDER BY [t].[RoleId], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0]
2021-05-21 14:47:03.932 +03:00 [INF] Executed DbCommand (54ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [e].[EntityDefinitionCode], [e].[Name]
FROM [Cofoundry].[EntityDefinition] AS [e]
2021-05-21 14:47:04.008 +03:00 [INF] Executed DbCommand (42ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[PermissionId], [p].[EntityDefinitionCode], [p].[PermissionCode]
FROM [Cofoundry].[Permission] AS [p]
2021-05-21 14:47:04.020 +03:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/add - -
2021-05-21 14:47:04.035 +03:00 [INF] CORS policy execution successful.
2021-05-21 14:47:04.052 +03:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/add - - - 204 - - 35.2141ms
2021-05-21 14:47:04.069 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/usersApi/add application/json 82
2021-05-21 14:47:04.071 +03:00 [INF] CORS policy execution successful.
2021-05-21 14:47:04.120 +03:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[RoleId], [r].[RoleCode], [r].[Title], [t].[RoleId], [t].[PermissionId], [t].[PermissionId0], [t].[EntityDefinitionCode], [t].[PermissionCode]
FROM [Cofoundry].[Role] AS [r]
LEFT JOIN (
    SELECT [r0].[RoleId], [r0].[PermissionId], [p].[PermissionId] AS [PermissionId0], [p].[EntityDefinitionCode], [p].[PermissionCode]
    FROM [Cofoundry].[RolePermission] AS [r0]
    INNER JOIN [Cofoundry].[Permission] AS [p] ON [r0].[PermissionId] = [p].[PermissionId]
) AS [t] ON [r].[RoleId] = [t].[RoleId]
ORDER BY [r].[RoleId], [t].[RoleId], [t].[PermissionId], [t].[PermissionId0]
2021-05-21 14:47:04.193 +03:00 [INF] Authorization was successful.
2021-05-21 14:47:04.195 +03:00 [INF] Executing endpoint 'Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin)'
2021-05-21 14:47:04.196 +03:00 [INF] "2021-05-21T11:47:03.6234560Z" SUCCESS executing command Cofoundry.Domain.RegisterPermissionsAndRolesCommand. User 1
2021-05-21 14:47:04.248 +03:00 [INF] Process completed
2021-05-21 14:47:04.278 +03:00 [INF] Route matched with {action = "Add", controller = "UsersApi"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.JsonResult] Add(Cofoundry.Domain.AddUserCommand) on controller Cofoundry.Web.Admin.UsersApiController (Dot.Web.Admin).
2021-05-21 14:47:04.422 +03:00 [INF] Executing action method Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin) - Validation state: "Valid"
2021-05-21 14:47:08.773 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-21 14:47:08.834 +03:00 [INF] Executed DbCommand (50ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE (([u].[UserId] = @__id_0) AND ([u].[IsDeleted] <> CAST(1 AS bit))) AND (([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit)))
2021-05-21 14:47:08.917 +03:00 [INF] Executed DbCommand (36ms) [Parameters=[@__roleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[RoleId], [t].[RoleCode], [t].[Title], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0], [t0].[EntityDefinitionCode], [t0].[PermissionCode]
FROM (
    SELECT TOP(1) [r].[RoleId], [r].[RoleCode], [r].[Title]
    FROM [Cofoundry].[Role] AS [r]
    WHERE [r].[RoleId] = @__roleId_0
) AS [t]
LEFT JOIN (
    SELECT [r0].[RoleId], [r0].[PermissionId], [p].[PermissionId] AS [PermissionId0], [p].[EntityDefinitionCode], [p].[PermissionCode]
    FROM [Cofoundry].[RolePermission] AS [r0]
    INNER JOIN [Cofoundry].[Permission] AS [p] ON [r0].[PermissionId] = [p].[PermissionId]
) AS [t0] ON [t].[RoleId] = [t0].[RoleId]
ORDER BY [t].[RoleId], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0]
2021-05-21 14:47:29.442 +03:00 [INF] Executed DbCommand (55ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CAST(0 AS bit)
2021-05-21 14:47:29.494 +03:00 [INF] Executed DbCommand (40ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[Role] AS [r]
WHERE [r].[RoleId] = @__id_0
2021-05-21 14:47:29.681 +03:00 [ERR] Failed executing DbCommand (51ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (Size = 150), @p3='?' (Size = 32), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTime2), @p8='?' (Size = 32), @p9='?' (DbType = DateTime2), @p10='?' (Size = 4000), @p11='?' (DbType = DateTime2), @p12='?' (DbType = Boolean), @p13='?' (DbType = Int32), @p14='?' (Size = 150)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Cofoundry].[User] ([CreateDate], [CreatorId], [Email], [FirstName], [IsDeleted], [IsEmailConfirmed], [IsSystemAccount], [LastLoginDate], [LastName], [LastPasswordChangeDate], [Password], [PreviousLoginDate], [RequirePasswordChange], [RoleId], [Username])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
SELECT [UserId]
FROM [Cofoundry].[User]
WHERE @@ROWCOUNT = 1 AND [UserId] = scope_identity();
2021-05-21 14:47:29.733 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Cofoundry.Domain.Data.CofoundryDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> System.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Username', table 'Cofoundry.BasicTestSite.Cofoundry.User'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__126_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__277_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:8782c5a0-8ed7-441e-b731-0d334f041f8c
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> System.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Username', table 'Cofoundry.BasicTestSite.Cofoundry.User'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__126_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__277_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:8782c5a0-8ed7-441e-b731-0d334f041f8c
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-05-21 14:47:29.935 +03:00 [INF] "2021-05-21T11:47:08.8625449Z" FAILED executing command Cofoundry.Domain.AddUserCommand. User 2, Exception 'An error occurred while updating the entries. See the inner exception for details.'
2021-05-21 14:47:30.328 +03:00 [INF] "2021-05-21T11:47:08.8625449Z" FAILED executing command Cofoundry.Domain.AddCofoundryUserCommand. User 2, Exception 'An error occurred while updating the entries. See the inner exception for details.'
2021-05-21 14:47:31.174 +03:00 [INF] Executed action Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin) in 26888.4141ms
2021-05-21 14:47:31.178 +03:00 [INF] Executed endpoint 'Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin)'
2021-05-21 14:47:31.188 +03:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> System.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Username', table 'Cofoundry.BasicTestSite.Cofoundry.User'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__126_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__277_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:8782c5a0-8ed7-441e-b731-0d334f041f8c
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Cofoundry.Domain.Internal.AddUserCommandHandler.ExecuteAsync(AddUserCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\Domain\Users\Commands\AddUserCommandHandler.cs:line 64
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteCommandAsync[TCommand](TCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 130
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteCommandAsync[TCommand](TCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 135
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteAsync(ICommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 107
   at Cofoundry.Domain.Internal.AddCofoundryUserCommandHandler.ExecuteAsync(AddCofoundryUserCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\Domain\Users\Commands\AddCofoundryUserCommandHandler.cs:line 47
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteCommandAsync[TCommand](TCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 130
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteCommandAsync[TCommand](TCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 135
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteAsync(ICommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 107
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteAsync(ICommand command) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 89
   at Cofoundry.Web.ApiResponseHelper.RunCommandAsync[TCommand](TCommand command) in C:\work\Github\PlatformFramework\src\Cofoundry.Web\Framework\WebApi\ApiResponseHelpers\ApiResponseHelper.cs:line 154
   at Cofoundry.Web.Admin.UsersApiController.Add(AddUserCommand command) in C:\work\Github\PlatformFramework\src\Cofoundry.Web.Admin\Admin\Api\Users\UsersApiController.cs:line 60
   at lambda_method308(Closure , Object )
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.ResponseCompression.ResponseCompressionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2021-05-21 14:47:31.345 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/usersApi/add application/json 82 - 500 - text/plain 27275.9230ms
2021-05-21 14:48:01.642 +03:00 [INF] User profile is available. Using 'C:\Users\Max\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2021-05-21 14:48:01.848 +03:00 [INF] Starting service
2021-05-21 14:48:02.806 +03:00 [INF] Now listening on: http://localhost:5000
2021-05-21 14:48:02.807 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2021-05-21 14:48:02.807 +03:00 [INF] Hosting environment: Development
2021-05-21 14:48:02.808 +03:00 [INF] Content root path: C:\work\Github\PlatformFramework\samples\Web.Service.Identity
2021-05-21 14:48:04.487 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-21 14:48:05.206 +03:00 [INF] Executed DbCommand (106ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE ([u].[IsDeleted] <> CAST(1 AS bit)) AND ([u].[IsSystemAccount] = CAST(1 AS bit))
2021-05-21 14:48:05.636 +03:00 [INF] Executed DbCommand (97ms) [Parameters=[@__roleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[RoleId], [t].[RoleCode], [t].[Title], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0], [t0].[EntityDefinitionCode], [t0].[PermissionCode]
FROM (
    SELECT TOP(1) [r].[RoleId], [r].[RoleCode], [r].[Title]
    FROM [Cofoundry].[Role] AS [r]
    WHERE [r].[RoleId] = @__roleId_0
) AS [t]
LEFT JOIN (
    SELECT [r0].[RoleId], [r0].[PermissionId], [p].[PermissionId] AS [PermissionId0], [p].[EntityDefinitionCode], [p].[PermissionCode]
    FROM [Cofoundry].[RolePermission] AS [r0]
    INNER JOIN [Cofoundry].[Permission] AS [p] ON [r0].[PermissionId] = [p].[PermissionId]
) AS [t0] ON [t].[RoleId] = [t0].[RoleId]
ORDER BY [t].[RoleId], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0]
2021-05-21 14:48:05.736 +03:00 [INF] Executed DbCommand (64ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [e].[EntityDefinitionCode], [e].[Name]
FROM [Cofoundry].[EntityDefinition] AS [e]
2021-05-21 14:48:05.818 +03:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[PermissionId], [p].[EntityDefinitionCode], [p].[PermissionCode]
FROM [Cofoundry].[Permission] AS [p]
2021-05-21 14:48:05.942 +03:00 [INF] Executed DbCommand (69ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[RoleId], [r].[RoleCode], [r].[Title], [t].[RoleId], [t].[PermissionId], [t].[PermissionId0], [t].[EntityDefinitionCode], [t].[PermissionCode]
FROM [Cofoundry].[Role] AS [r]
LEFT JOIN (
    SELECT [r0].[RoleId], [r0].[PermissionId], [p].[PermissionId] AS [PermissionId0], [p].[EntityDefinitionCode], [p].[PermissionCode]
    FROM [Cofoundry].[RolePermission] AS [r0]
    INNER JOIN [Cofoundry].[Permission] AS [p] ON [r0].[PermissionId] = [p].[PermissionId]
) AS [t] ON [r].[RoleId] = [t].[RoleId]
ORDER BY [r].[RoleId], [t].[RoleId], [t].[PermissionId], [t].[PermissionId0]
2021-05-21 14:48:06.041 +03:00 [INF] "2021-05-21T11:48:05.3892876Z" SUCCESS executing command Cofoundry.Domain.RegisterPermissionsAndRolesCommand. User 1
2021-05-21 14:48:06.119 +03:00 [INF] Process completed
2021-05-21 14:48:08.431 +03:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/add - -
2021-05-21 14:48:08.442 +03:00 [INF] CORS policy execution successful.
2021-05-21 14:48:08.456 +03:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/add - - - 204 - - 26.8553ms
2021-05-21 14:48:08.467 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/usersApi/add application/json 82
2021-05-21 14:48:08.470 +03:00 [INF] CORS policy execution successful.
2021-05-21 14:48:08.535 +03:00 [INF] Authorization was successful.
2021-05-21 14:48:08.536 +03:00 [INF] Executing endpoint 'Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin)'
2021-05-21 14:48:08.562 +03:00 [INF] Route matched with {action = "Add", controller = "UsersApi"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.JsonResult] Add(Cofoundry.Domain.AddUserCommand) on controller Cofoundry.Web.Admin.UsersApiController (Dot.Web.Admin).
2021-05-21 14:48:08.687 +03:00 [INF] Executing action method Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin) - Validation state: "Valid"
2021-05-21 14:48:11.634 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-21 14:48:11.702 +03:00 [INF] Executed DbCommand (58ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE (([u].[UserId] = @__id_0) AND ([u].[IsDeleted] <> CAST(1 AS bit))) AND (([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit)))
2021-05-21 14:48:11.763 +03:00 [INF] Executed DbCommand (39ms) [Parameters=[@__roleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[RoleId], [t].[RoleCode], [t].[Title], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0], [t0].[EntityDefinitionCode], [t0].[PermissionCode]
FROM (
    SELECT TOP(1) [r].[RoleId], [r].[RoleCode], [r].[Title]
    FROM [Cofoundry].[Role] AS [r]
    WHERE [r].[RoleId] = @__roleId_0
) AS [t]
LEFT JOIN (
    SELECT [r0].[RoleId], [r0].[PermissionId], [p].[PermissionId] AS [PermissionId0], [p].[EntityDefinitionCode], [p].[PermissionCode]
    FROM [Cofoundry].[RolePermission] AS [r0]
    INNER JOIN [Cofoundry].[Permission] AS [p] ON [r0].[PermissionId] = [p].[PermissionId]
) AS [t0] ON [t].[RoleId] = [t0].[RoleId]
ORDER BY [t].[RoleId], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0]
2021-05-21 14:48:18.056 +03:00 [INF] "2021-05-21T11:48:11.7081237Z" FAILED executing command Cofoundry.Domain.AddUserCommand. User 2, Exception 'Username field is required'
2021-05-21 14:48:28.610 +03:00 [INF] "2021-05-21T11:48:11.7081237Z" FAILED executing command Cofoundry.Domain.AddCofoundryUserCommand. User 2, Exception 'Username field is required'
2021-05-21 14:48:28.951 +03:00 [INF] Executed action method Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin), returned result Microsoft.AspNetCore.Mvc.JsonResult in 20256.1251ms.
2021-05-21 14:48:28.957 +03:00 [INF] Executing JsonResult, writing value of type 'Cofoundry.Web.SimpleCommandResponseData`1[[System.Object, System.Private.CoreLib, Version=5.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2021-05-21 14:48:29.005 +03:00 [INF] Executed action Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin) in 20436.4404ms
2021-05-21 14:48:29.008 +03:00 [INF] Executed endpoint 'Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin)'
2021-05-21 14:48:29.020 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/usersApi/add application/json 82 - 400 - application/json;+charset=utf-8 20552.4312ms
2021-05-21 14:48:37.871 +03:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/add - -
2021-05-21 14:48:37.873 +03:00 [INF] CORS policy execution successful.
2021-05-21 14:48:37.874 +03:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/add - - - 204 - - 3.2239ms
2021-05-21 14:48:37.888 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/usersApi/add application/json 82
2021-05-21 14:48:37.894 +03:00 [INF] CORS policy execution successful.
2021-05-21 14:48:37.898 +03:00 [INF] Authorization was successful.
2021-05-21 14:48:37.898 +03:00 [INF] Executing endpoint 'Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin)'
2021-05-21 14:48:37.900 +03:00 [INF] Route matched with {action = "Add", controller = "UsersApi"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.JsonResult] Add(Cofoundry.Domain.AddUserCommand) on controller Cofoundry.Web.Admin.UsersApiController (Dot.Web.Admin).
2021-05-21 14:48:37.925 +03:00 [INF] Executing action method Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin) - Validation state: "Valid"
2021-05-21 14:48:37.934 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-21 14:48:37.970 +03:00 [INF] Executed DbCommand (34ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE (([u].[UserId] = @__id_0) AND ([u].[IsDeleted] <> CAST(1 AS bit))) AND (([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit)))
2021-05-21 14:49:36.512 +03:00 [INF] User profile is available. Using 'C:\Users\Max\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2021-05-21 14:49:36.813 +03:00 [INF] Starting service
2021-05-21 14:49:38.208 +03:00 [INF] Now listening on: http://localhost:5000
2021-05-21 14:49:38.209 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2021-05-21 14:49:38.209 +03:00 [INF] Hosting environment: Development
2021-05-21 14:49:38.210 +03:00 [INF] Content root path: C:\work\Github\PlatformFramework\samples\Web.Service.Identity
2021-05-21 14:49:39.925 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-21 14:49:40.578 +03:00 [INF] Executed DbCommand (96ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE ([u].[IsDeleted] <> CAST(1 AS bit)) AND ([u].[IsSystemAccount] = CAST(1 AS bit))
2021-05-21 14:49:40.998 +03:00 [INF] Executed DbCommand (95ms) [Parameters=[@__roleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[RoleId], [t].[RoleCode], [t].[Title], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0], [t0].[EntityDefinitionCode], [t0].[PermissionCode]
FROM (
    SELECT TOP(1) [r].[RoleId], [r].[RoleCode], [r].[Title]
    FROM [Cofoundry].[Role] AS [r]
    WHERE [r].[RoleId] = @__roleId_0
) AS [t]
LEFT JOIN (
    SELECT [r0].[RoleId], [r0].[PermissionId], [p].[PermissionId] AS [PermissionId0], [p].[EntityDefinitionCode], [p].[PermissionCode]
    FROM [Cofoundry].[RolePermission] AS [r0]
    INNER JOIN [Cofoundry].[Permission] AS [p] ON [r0].[PermissionId] = [p].[PermissionId]
) AS [t0] ON [t].[RoleId] = [t0].[RoleId]
ORDER BY [t].[RoleId], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0]
2021-05-21 14:49:41.096 +03:00 [INF] Executed DbCommand (64ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [e].[EntityDefinitionCode], [e].[Name]
FROM [Cofoundry].[EntityDefinition] AS [e]
2021-05-21 14:49:41.181 +03:00 [INF] Executed DbCommand (50ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[PermissionId], [p].[EntityDefinitionCode], [p].[PermissionCode]
FROM [Cofoundry].[Permission] AS [p]
2021-05-21 14:49:41.278 +03:00 [INF] Executed DbCommand (50ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[RoleId], [r].[RoleCode], [r].[Title], [t].[RoleId], [t].[PermissionId], [t].[PermissionId0], [t].[EntityDefinitionCode], [t].[PermissionCode]
FROM [Cofoundry].[Role] AS [r]
LEFT JOIN (
    SELECT [r0].[RoleId], [r0].[PermissionId], [p].[PermissionId] AS [PermissionId0], [p].[EntityDefinitionCode], [p].[PermissionCode]
    FROM [Cofoundry].[RolePermission] AS [r0]
    INNER JOIN [Cofoundry].[Permission] AS [p] ON [r0].[PermissionId] = [p].[PermissionId]
) AS [t] ON [r].[RoleId] = [t].[RoleId]
ORDER BY [r].[RoleId], [t].[RoleId], [t].[PermissionId], [t].[PermissionId0]
2021-05-21 14:49:41.374 +03:00 [INF] "2021-05-21T11:49:40.7483324Z" SUCCESS executing command Cofoundry.Domain.RegisterPermissionsAndRolesCommand. User 1
2021-05-21 14:49:41.443 +03:00 [INF] Process completed
2021-05-21 14:49:43.849 +03:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/add - -
2021-05-21 14:49:43.861 +03:00 [INF] CORS policy execution successful.
2021-05-21 14:49:43.875 +03:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/add - - - 204 - - 27.7503ms
2021-05-21 14:49:43.887 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/usersApi/add application/json 82
2021-05-21 14:49:43.890 +03:00 [INF] CORS policy execution successful.
2021-05-21 14:49:43.953 +03:00 [INF] Authorization was successful.
2021-05-21 14:49:43.954 +03:00 [INF] Executing endpoint 'Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin)'
2021-05-21 14:49:43.981 +03:00 [INF] Route matched with {action = "Add", controller = "UsersApi"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.JsonResult] Add(Cofoundry.Domain.AddUserCommand) on controller Cofoundry.Web.Admin.UsersApiController (Dot.Web.Admin).
2021-05-21 14:49:44.114 +03:00 [INF] Executing action method Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin) - Validation state: "Valid"
2021-05-21 14:49:44.153 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-21 14:49:44.228 +03:00 [INF] Executed DbCommand (66ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE (([u].[UserId] = @__id_0) AND ([u].[IsDeleted] <> CAST(1 AS bit))) AND (([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit)))
2021-05-21 14:49:44.302 +03:00 [INF] Executed DbCommand (48ms) [Parameters=[@__roleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[RoleId], [t].[RoleCode], [t].[Title], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0], [t0].[EntityDefinitionCode], [t0].[PermissionCode]
FROM (
    SELECT TOP(1) [r].[RoleId], [r].[RoleCode], [r].[Title]
    FROM [Cofoundry].[Role] AS [r]
    WHERE [r].[RoleId] = @__roleId_0
) AS [t]
LEFT JOIN (
    SELECT [r0].[RoleId], [r0].[PermissionId], [p].[PermissionId] AS [PermissionId0], [p].[EntityDefinitionCode], [p].[PermissionCode]
    FROM [Cofoundry].[RolePermission] AS [r0]
    INNER JOIN [Cofoundry].[Permission] AS [p] ON [r0].[PermissionId] = [p].[PermissionId]
) AS [t0] ON [t].[RoleId] = [t0].[RoleId]
ORDER BY [t].[RoleId], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0]
2021-05-21 14:49:48.620 +03:00 [INF] Executed DbCommand (61ms) [Parameters=[@__query_Username_1='?' (Size = 150)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Cofoundry].[User] AS [u]
        WHERE ([u].[IsDeleted] <> CAST(1 AS bit)) AND ([u].[Username] = @__query_Username_1)) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-05-21 14:49:48.674 +03:00 [INF] Executed DbCommand (44ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[Role] AS [r]
WHERE [r].[RoleId] = @__id_0
2021-05-21 14:49:48.874 +03:00 [ERR] Failed executing DbCommand (56ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (Size = 150), @p3='?' (Size = 32), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTime2), @p8='?' (Size = 32), @p9='?' (DbType = DateTime2), @p10='?' (Size = 4000), @p11='?' (DbType = DateTime2), @p12='?' (DbType = Boolean), @p13='?' (DbType = Int32), @p14='?' (Size = 150)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Cofoundry].[User] ([CreateDate], [CreatorId], [Email], [FirstName], [IsDeleted], [IsEmailConfirmed], [IsSystemAccount], [LastLoginDate], [LastName], [LastPasswordChangeDate], [Password], [PreviousLoginDate], [RequirePasswordChange], [RoleId], [Username])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
SELECT [UserId]
FROM [Cofoundry].[User]
WHERE @@ROWCOUNT = 1 AND [UserId] = scope_identity();
2021-05-21 14:49:48.928 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Cofoundry.Domain.Data.CofoundryDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> System.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'UserAreaCode', table 'Cofoundry.BasicTestSite.Cofoundry.User'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__126_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__277_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:c9bf1dec-fb7c-4bf3-a912-4981c75c988d
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> System.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'UserAreaCode', table 'Cofoundry.BasicTestSite.Cofoundry.User'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__126_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__277_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:c9bf1dec-fb7c-4bf3-a912-4981c75c988d
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-05-21 14:49:49.164 +03:00 [INF] "2021-05-21T11:49:44.2319611Z" FAILED executing command Cofoundry.Domain.AddUserCommand. User 2, Exception 'An error occurred while updating the entries. See the inner exception for details.'
2021-05-21 14:49:49.571 +03:00 [INF] "2021-05-21T11:49:44.2319611Z" FAILED executing command Cofoundry.Domain.AddCofoundryUserCommand. User 2, Exception 'An error occurred while updating the entries. See the inner exception for details.'
2021-05-21 14:49:50.209 +03:00 [INF] Executed action Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin) in 6220.4226ms
2021-05-21 14:49:50.212 +03:00 [INF] Executed endpoint 'Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin)'
2021-05-21 14:49:50.220 +03:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> System.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'UserAreaCode', table 'Cofoundry.BasicTestSite.Cofoundry.User'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__126_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__277_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:c9bf1dec-fb7c-4bf3-a912-4981c75c988d
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Cofoundry.Domain.Internal.AddUserCommandHandler.ExecuteAsync(AddUserCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\Domain\Users\Commands\AddUserCommandHandler.cs:line 64
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteCommandAsync[TCommand](TCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 130
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteCommandAsync[TCommand](TCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 135
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteAsync(ICommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 107
   at Cofoundry.Domain.Internal.AddCofoundryUserCommandHandler.ExecuteAsync(AddCofoundryUserCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\Domain\Users\Commands\AddCofoundryUserCommandHandler.cs:line 47
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteCommandAsync[TCommand](TCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 130
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteCommandAsync[TCommand](TCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 135
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteAsync(ICommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 107
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteAsync(ICommand command) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 89
   at Cofoundry.Web.ApiResponseHelper.RunCommandAsync[TCommand](TCommand command) in C:\work\Github\PlatformFramework\src\Cofoundry.Web\Framework\WebApi\ApiResponseHelpers\ApiResponseHelper.cs:line 154
   at Cofoundry.Web.Admin.UsersApiController.Add(AddUserCommand command) in C:\work\Github\PlatformFramework\src\Cofoundry.Web.Admin\Admin\Api\Users\UsersApiController.cs:line 60
   at lambda_method308(Closure , Object )
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.ResponseCompression.ResponseCompressionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2021-05-21 14:49:50.300 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/usersApi/add application/json 82 - 500 - text/plain 6413.0175ms
2021-05-21 14:50:22.890 +03:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/add - -
2021-05-21 14:50:22.895 +03:00 [INF] CORS policy execution successful.
2021-05-21 14:50:22.895 +03:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/add - - - 204 - - 5.1901ms
2021-05-21 14:50:22.909 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/usersApi/add application/json 82
2021-05-21 14:50:22.911 +03:00 [INF] CORS policy execution successful.
2021-05-21 14:50:22.948 +03:00 [INF] Authorization was successful.
2021-05-21 14:50:22.957 +03:00 [INF] Executing endpoint 'Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin)'
2021-05-21 14:50:22.958 +03:00 [INF] Route matched with {action = "Add", controller = "UsersApi"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.JsonResult] Add(Cofoundry.Domain.AddUserCommand) on controller Cofoundry.Web.Admin.UsersApiController (Dot.Web.Admin).
2021-05-21 14:50:22.983 +03:00 [INF] Executing action method Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin) - Validation state: "Valid"
2021-05-21 14:50:22.991 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-21 14:50:23.029 +03:00 [INF] Executed DbCommand (37ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE (([u].[UserId] = @__id_0) AND ([u].[IsDeleted] <> CAST(1 AS bit))) AND (([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit)))
2021-05-21 14:50:28.643 +03:00 [INF] Executed DbCommand (41ms) [Parameters=[@__query_Username_1='?' (Size = 150)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Cofoundry].[User] AS [u]
        WHERE ([u].[IsDeleted] <> CAST(1 AS bit)) AND ([u].[Username] = @__query_Username_1)) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-05-21 14:50:32.677 +03:00 [INF] Executed DbCommand (41ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[Role] AS [r]
WHERE [r].[RoleId] = @__id_0
2021-05-21 14:50:34.928 +03:00 [ERR] Failed executing DbCommand (63ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (Size = 150), @p3='?' (Size = 32), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTime2), @p8='?' (Size = 32), @p9='?' (DbType = DateTime2), @p10='?' (Size = 4000), @p11='?' (DbType = DateTime2), @p12='?' (DbType = Boolean), @p13='?' (DbType = Int32), @p14='?' (Size = 150)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Cofoundry].[User] ([CreateDate], [CreatorId], [Email], [FirstName], [IsDeleted], [IsEmailConfirmed], [IsSystemAccount], [LastLoginDate], [LastName], [LastPasswordChangeDate], [Password], [PreviousLoginDate], [RequirePasswordChange], [RoleId], [Username])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
SELECT [UserId]
FROM [Cofoundry].[User]
WHERE @@ROWCOUNT = 1 AND [UserId] = scope_identity();
2021-05-21 14:50:34.935 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Cofoundry.Domain.Data.CofoundryDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> System.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'UserAreaCode', table 'Cofoundry.BasicTestSite.Cofoundry.User'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__126_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__277_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:c9bf1dec-fb7c-4bf3-a912-4981c75c988d
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> System.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'UserAreaCode', table 'Cofoundry.BasicTestSite.Cofoundry.User'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__126_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__277_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:c9bf1dec-fb7c-4bf3-a912-4981c75c988d
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-05-21 14:50:35.197 +03:00 [INF] "2021-05-21T11:50:23.0326630Z" FAILED executing command Cofoundry.Domain.AddUserCommand. User 2, Exception 'An error occurred while updating the entries. See the inner exception for details.'
2021-05-21 14:50:35.556 +03:00 [INF] "2021-05-21T11:50:23.0326630Z" FAILED executing command Cofoundry.Domain.AddCofoundryUserCommand. User 2, Exception 'An error occurred while updating the entries. See the inner exception for details.'
2021-05-21 14:50:36.128 +03:00 [INF] Executed action Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin) in 13169.8404ms
2021-05-21 14:50:36.134 +03:00 [INF] Executed endpoint 'Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin)'
2021-05-21 14:50:36.137 +03:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> System.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'UserAreaCode', table 'Cofoundry.BasicTestSite.Cofoundry.User'; column does not allow nulls. INSERT fails.
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__126_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__277_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:c9bf1dec-fb7c-4bf3-a912-4981c75c988d
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Cofoundry.Domain.Internal.AddUserCommandHandler.ExecuteAsync(AddUserCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\Domain\Users\Commands\AddUserCommandHandler.cs:line 64
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteCommandAsync[TCommand](TCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 130
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteCommandAsync[TCommand](TCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 135
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteAsync(ICommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 107
   at Cofoundry.Domain.Internal.AddCofoundryUserCommandHandler.ExecuteAsync(AddCofoundryUserCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\Domain\Users\Commands\AddCofoundryUserCommandHandler.cs:line 47
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteCommandAsync[TCommand](TCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 130
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteCommandAsync[TCommand](TCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 135
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteAsync(ICommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 107
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteAsync(ICommand command) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 89
   at Cofoundry.Web.ApiResponseHelper.RunCommandAsync[TCommand](TCommand command) in C:\work\Github\PlatformFramework\src\Cofoundry.Web\Framework\WebApi\ApiResponseHelpers\ApiResponseHelper.cs:line 154
   at Cofoundry.Web.Admin.UsersApiController.Add(AddUserCommand command) in C:\work\Github\PlatformFramework\src\Cofoundry.Web.Admin\Admin\Api\Users\UsersApiController.cs:line 60
   at lambda_method308(Closure , Object )
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.ResponseCompression.ResponseCompressionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2021-05-21 14:50:36.181 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/usersApi/add application/json 82 - 500 - text/plain 13272.0256ms
2021-05-21 14:51:22.894 +03:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/add - -
2021-05-21 14:51:22.898 +03:00 [INF] CORS policy execution successful.
2021-05-21 14:51:22.898 +03:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/add - - - 204 - - 31.5879ms
2021-05-21 14:51:22.918 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/usersApi/add application/json 82
2021-05-21 14:51:22.919 +03:00 [INF] CORS policy execution successful.
2021-05-21 14:51:22.921 +03:00 [INF] Authorization was successful.
2021-05-21 14:51:22.922 +03:00 [INF] Executing endpoint 'Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin)'
2021-05-21 14:51:22.923 +03:00 [INF] Route matched with {action = "Add", controller = "UsersApi"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.JsonResult] Add(Cofoundry.Domain.AddUserCommand) on controller Cofoundry.Web.Admin.UsersApiController (Dot.Web.Admin).
2021-05-21 14:51:22.946 +03:00 [INF] Executing action method Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin) - Validation state: "Valid"
2021-05-21 14:51:22.948 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-21 14:51:22.985 +03:00 [INF] Executed DbCommand (36ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE (([u].[UserId] = @__id_0) AND ([u].[IsDeleted] <> CAST(1 AS bit))) AND (([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit)))
2021-05-21 14:51:24.762 +03:00 [INF] Executed DbCommand (38ms) [Parameters=[@__query_Username_1='?' (Size = 150)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Cofoundry].[User] AS [u]
        WHERE ([u].[IsDeleted] <> CAST(1 AS bit)) AND ([u].[Username] = @__query_Username_1)) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-05-21 14:51:25.566 +03:00 [INF] Executed DbCommand (30ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[Role] AS [r]
WHERE [r].[RoleId] = @__id_0
2021-05-21 14:51:26.748 +03:00 [INF] Executed DbCommand (54ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (Size = 150), @p3='?' (Size = 32), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTime2), @p8='?' (Size = 32), @p9='?' (DbType = DateTime2), @p10='?' (Size = 4000), @p11='?' (DbType = DateTime2), @p12='?' (DbType = Boolean), @p13='?' (DbType = Int32), @p14='?' (Size = 150)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Cofoundry].[User] ([CreateDate], [CreatorId], [Email], [FirstName], [IsDeleted], [IsEmailConfirmed], [IsSystemAccount], [LastLoginDate], [LastName], [LastPasswordChangeDate], [Password], [PreviousLoginDate], [RequirePasswordChange], [RoleId], [Username])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
SELECT [UserId]
FROM [Cofoundry].[User]
WHERE @@ROWCOUNT = 1 AND [UserId] = scope_identity();
2021-05-21 14:51:33.483 +03:00 [INF] "2021-05-21T11:51:22.9930847Z" SUCCESS executing command Cofoundry.Domain.AddUserCommand. User 2
2021-05-21 15:13:34.948 +03:00 [INF] User profile is available. Using 'C:\Users\Max\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2021-05-21 15:13:35.150 +03:00 [INF] Starting service
2021-05-21 15:13:36.263 +03:00 [INF] Now listening on: http://localhost:5000
2021-05-21 15:13:36.264 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2021-05-21 15:13:36.264 +03:00 [INF] Hosting environment: Development
2021-05-21 15:13:36.264 +03:00 [INF] Content root path: C:\work\Github\PlatformFramework\samples\Web.Service.Identity
2021-05-21 15:13:37.921 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-21 15:13:38.751 +03:00 [INF] Executed DbCommand (105ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE ([u].[IsDeleted] <> CAST(1 AS bit)) AND ([u].[IsSystemAccount] = CAST(1 AS bit))
2021-05-21 15:13:39.270 +03:00 [INF] Executed DbCommand (114ms) [Parameters=[@__roleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[RoleId], [t].[RoleCode], [t].[Title], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0], [t0].[EntityDefinitionCode], [t0].[PermissionCode]
FROM (
    SELECT TOP(1) [r].[RoleId], [r].[RoleCode], [r].[Title]
    FROM [Cofoundry].[Role] AS [r]
    WHERE [r].[RoleId] = @__roleId_0
) AS [t]
LEFT JOIN (
    SELECT [r0].[RoleId], [r0].[PermissionId], [p].[PermissionId] AS [PermissionId0], [p].[EntityDefinitionCode], [p].[PermissionCode]
    FROM [Cofoundry].[RolePermission] AS [r0]
    INNER JOIN [Cofoundry].[Permission] AS [p] ON [r0].[PermissionId] = [p].[PermissionId]
) AS [t0] ON [t].[RoleId] = [t0].[RoleId]
ORDER BY [t].[RoleId], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0]
2021-05-21 15:13:39.384 +03:00 [INF] Executed DbCommand (72ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [e].[EntityDefinitionCode], [e].[Name]
FROM [Cofoundry].[EntityDefinition] AS [e]
2021-05-21 15:13:39.473 +03:00 [INF] Executed DbCommand (56ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[PermissionId], [p].[EntityDefinitionCode], [p].[PermissionCode]
FROM [Cofoundry].[Permission] AS [p]
2021-05-21 15:13:39.617 +03:00 [INF] Executed DbCommand (75ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[RoleId], [r].[RoleCode], [r].[Title], [t].[RoleId], [t].[PermissionId], [t].[PermissionId0], [t].[EntityDefinitionCode], [t].[PermissionCode]
FROM [Cofoundry].[Role] AS [r]
LEFT JOIN (
    SELECT [r0].[RoleId], [r0].[PermissionId], [p].[PermissionId] AS [PermissionId0], [p].[EntityDefinitionCode], [p].[PermissionCode]
    FROM [Cofoundry].[RolePermission] AS [r0]
    INNER JOIN [Cofoundry].[Permission] AS [p] ON [r0].[PermissionId] = [p].[PermissionId]
) AS [t] ON [r].[RoleId] = [t].[RoleId]
ORDER BY [r].[RoleId], [t].[RoleId], [t].[PermissionId], [t].[PermissionId0]
2021-05-21 15:13:39.724 +03:00 [INF] "2021-05-21T12:13:38.9763771Z" SUCCESS executing command Cofoundry.Domain.RegisterPermissionsAndRolesCommand. User 1
2021-05-21 15:13:39.806 +03:00 [INF] Process completed
2021-05-21 15:13:47.236 +03:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/rolesApi/getAll - -
2021-05-21 15:13:47.247 +03:00 [INF] CORS policy execution successful.
2021-05-21 15:13:47.262 +03:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/api/rolesApi/getAll - - - 204 - - 28.8642ms
2021-05-21 15:13:47.275 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/rolesApi/getAll application/json 25
2021-05-21 15:13:47.279 +03:00 [INF] CORS policy execution successful.
2021-05-21 15:13:47.373 +03:00 [INF] Authorization was successful.
2021-05-21 15:13:47.375 +03:00 [INF] Executing endpoint 'Cofoundry.Web.Admin.RolesApiController.GetAll (Dot.Web.Admin)'
2021-05-21 15:13:47.413 +03:00 [INF] Route matched with {action = "GetAll", controller = "RolesApi"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.JsonResult] GetAll(Cofoundry.Domain.SearchRolesQuery) on controller Cofoundry.Web.Admin.RolesApiController (Dot.Web.Admin).
2021-05-21 15:13:47.552 +03:00 [INF] Executing action method Cofoundry.Web.Admin.RolesApiController.GetAll (Dot.Web.Admin) - Validation state: "Valid"
2021-05-21 15:13:47.601 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-21 15:13:47.701 +03:00 [INF] Executed DbCommand (91ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE (([u].[UserId] = @__id_0) AND ([u].[IsDeleted] <> CAST(1 AS bit))) AND (([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit)))
2021-05-21 15:13:47.765 +03:00 [INF] Executed DbCommand (52ms) [Parameters=[@__roleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[RoleId], [t].[RoleCode], [t].[Title], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0], [t0].[EntityDefinitionCode], [t0].[PermissionCode]
FROM (
    SELECT TOP(1) [r].[RoleId], [r].[RoleCode], [r].[Title]
    FROM [Cofoundry].[Role] AS [r]
    WHERE [r].[RoleId] = @__roleId_0
) AS [t]
LEFT JOIN (
    SELECT [r0].[RoleId], [r0].[PermissionId], [p].[PermissionId] AS [PermissionId0], [p].[EntityDefinitionCode], [p].[PermissionCode]
    FROM [Cofoundry].[RolePermission] AS [r0]
    INNER JOIN [Cofoundry].[Permission] AS [p] ON [r0].[PermissionId] = [p].[PermissionId]
) AS [t0] ON [t].[RoleId] = [t0].[RoleId]
ORDER BY [t].[RoleId], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0]
2021-05-21 15:13:47.870 +03:00 [INF] Executed DbCommand (72ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Cofoundry].[Role] AS [r]
WHERE ([r].[RoleCode] <> 'ANO') OR [r].[RoleCode] IS NULL
2021-05-21 15:13:47.942 +03:00 [INF] Executed DbCommand (56ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[Role] AS [r]
WHERE ([r].[RoleCode] <> 'ANO') OR [r].[RoleCode] IS NULL
ORDER BY [r].[Title]
2021-05-21 15:13:47.957 +03:00 [INF] Executed action method Cofoundry.Web.Admin.RolesApiController.GetAll (Dot.Web.Admin), returned result Microsoft.AspNetCore.Mvc.JsonResult in 396.2079ms.
2021-05-21 15:13:47.964 +03:00 [INF] Executing JsonResult, writing value of type 'Cofoundry.Domain.PagedQueryResult`1[[Cofoundry.Domain.RoleMicroSummary, Dot.Domain, Version=0.7.0.0, Culture=neutral, PublicKeyToken=null]]'.
2021-05-21 15:13:48.024 +03:00 [INF] Executed action Cofoundry.Web.Admin.RolesApiController.GetAll (Dot.Web.Admin) in 599.9947ms
2021-05-21 15:13:48.026 +03:00 [INF] Executed endpoint 'Cofoundry.Web.Admin.RolesApiController.GetAll (Dot.Web.Admin)'
2021-05-21 15:13:48.034 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/rolesApi/getAll application/json 25 - 200 - application/json;+charset=utf-8 759.5533ms
2021-05-21 15:13:50.168 +03:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/getAll - -
2021-05-21 15:13:50.170 +03:00 [INF] CORS policy execution successful.
2021-05-21 15:13:50.171 +03:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/getAll - - - 204 - - 3.3159ms
2021-05-21 15:13:50.184 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/usersApi/getAll application/json 31
2021-05-21 15:13:50.185 +03:00 [INF] CORS policy execution successful.
2021-05-21 15:13:50.197 +03:00 [INF] Authorization was successful.
2021-05-21 15:13:50.197 +03:00 [INF] Executing endpoint 'Cofoundry.Web.Admin.UsersApiController.GetAll (Dot.Web.Admin)'
2021-05-21 15:13:50.204 +03:00 [INF] Route matched with {action = "GetAll", controller = "UsersApi"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.JsonResult] GetAll(Cofoundry.Domain.SearchUserSummariesQuery) on controller Cofoundry.Web.Admin.UsersApiController (Dot.Web.Admin).
2021-05-21 15:13:50.237 +03:00 [INF] Executing action method Cofoundry.Web.Admin.UsersApiController.GetAll (Dot.Web.Admin) - Validation state: "Valid"
2021-05-21 15:13:50.246 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-21 15:13:50.284 +03:00 [INF] Executed DbCommand (35ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE (([u].[UserId] = @__id_0) AND ([u].[IsDeleted] <> CAST(1 AS bit))) AND (([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit)))
2021-05-21 15:13:50.340 +03:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Cofoundry].[User] AS [u]
WHERE ([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit))
2021-05-21 15:13:50.378 +03:00 [INF] Executed DbCommand (28ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[UserId], [t].[CreateDate], [t].[CreatorId], [t].[Email], [t].[FirstName], [t].[IsDeleted], [t].[IsEmailConfirmed], [t].[IsSystemAccount], [t].[LastLoginDate], [t].[LastName], [t].[LastPasswordChangeDate], [t].[Password], [t].[PreviousLoginDate], [t].[RequirePasswordChange], [t].[RoleId], [t].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM (
    SELECT [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username]
    FROM [Cofoundry].[User] AS [u]
    WHERE ([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit))
    ORDER BY [u].[LastName]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t]
INNER JOIN [Cofoundry].[Role] AS [r] ON [t].[RoleId] = [r].[RoleId]
ORDER BY [t].[LastName]
2021-05-21 15:13:50.385 +03:00 [INF] Executed action method Cofoundry.Web.Admin.UsersApiController.GetAll (Dot.Web.Admin), returned result Microsoft.AspNetCore.Mvc.JsonResult in 146.3058ms.
2021-05-21 15:13:50.387 +03:00 [INF] Executing JsonResult, writing value of type 'Cofoundry.Domain.PagedQueryResult`1[[Cofoundry.Domain.UserSummary, Dot.Domain, Version=0.7.0.0, Culture=neutral, PublicKeyToken=null]]'.
2021-05-21 15:13:50.397 +03:00 [INF] Executed action Cofoundry.Web.Admin.UsersApiController.GetAll (Dot.Web.Admin) in 190.7743ms
2021-05-21 15:13:50.397 +03:00 [INF] Executed endpoint 'Cofoundry.Web.Admin.UsersApiController.GetAll (Dot.Web.Admin)'
2021-05-21 15:13:50.399 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/usersApi/getAll application/json 31 - 200 - application/json;+charset=utf-8 214.5804ms
2021-05-21 15:14:05.436 +03:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/add - -
2021-05-21 15:14:05.437 +03:00 [INF] CORS policy execution successful.
2021-05-21 15:14:05.437 +03:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/add - - - 204 - - 1.7483ms
2021-05-21 15:14:05.451 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/usersApi/add application/json 88
2021-05-21 15:14:05.452 +03:00 [INF] CORS policy execution successful.
2021-05-21 15:14:05.456 +03:00 [INF] Authorization was successful.
2021-05-21 15:14:05.456 +03:00 [INF] Executing endpoint 'Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin)'
2021-05-21 15:14:05.460 +03:00 [INF] Route matched with {action = "Add", controller = "UsersApi"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.JsonResult] Add(Cofoundry.Domain.AddUserCommand) on controller Cofoundry.Web.Admin.UsersApiController (Dot.Web.Admin).
2021-05-21 15:14:05.506 +03:00 [INF] Executing action method Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin) - Validation state: "Valid"
2021-05-21 15:14:05.518 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-21 15:14:05.564 +03:00 [INF] Executed DbCommand (44ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE (([u].[UserId] = @__id_0) AND ([u].[IsDeleted] <> CAST(1 AS bit))) AND (([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit)))
2021-05-21 15:14:05.666 +03:00 [INF] Executed DbCommand (61ms) [Parameters=[@__query_Username_1='?' (Size = 150)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Cofoundry].[User] AS [u]
        WHERE ([u].[IsDeleted] <> CAST(1 AS bit)) AND ([u].[Username] = @__query_Username_1)) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-05-21 15:14:05.721 +03:00 [INF] Executed DbCommand (40ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[Role] AS [r]
WHERE [r].[RoleId] = @__id_0
2021-05-21 15:14:05.905 +03:00 [ERR] Failed executing DbCommand (49ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (Size = 150), @p3='?' (Size = 32), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTime2), @p8='?' (Size = 32), @p9='?' (DbType = DateTime2), @p10='?' (Size = 4000), @p11='?' (DbType = DateTime2), @p12='?' (DbType = Boolean), @p13='?' (DbType = Int32), @p14='?' (Size = 150)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Cofoundry].[User] ([CreateDate], [CreatorId], [Email], [FirstName], [IsDeleted], [IsEmailConfirmed], [IsSystemAccount], [LastLoginDate], [LastName], [LastPasswordChangeDate], [Password], [PreviousLoginDate], [RequirePasswordChange], [RoleId], [Username])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
SELECT [UserId]
FROM [Cofoundry].[User]
WHERE @@ROWCOUNT = 1 AND [UserId] = scope_identity();
2021-05-21 15:14:05.956 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Cofoundry.Domain.Data.CofoundryDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> System.Data.SqlClient.SqlException (0x80131904): Cannot insert duplicate key row in object 'Cofoundry.User' with unique index 'UIX_User_Email'. The duplicate key value is (<NULL>, 33@mail.com).
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__126_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:511f1f2d-835b-4fa0-9abf-49cd2fcc3687
Error Number:2601,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> System.Data.SqlClient.SqlException (0x80131904): Cannot insert duplicate key row in object 'Cofoundry.User' with unique index 'UIX_User_Email'. The duplicate key value is (<NULL>, 33@mail.com).
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__126_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:511f1f2d-835b-4fa0-9abf-49cd2fcc3687
Error Number:2601,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-05-21 15:14:06.120 +03:00 [INF] "2021-05-21T12:14:05.5675953Z" FAILED executing command Cofoundry.Domain.AddUserCommand. User 2, Exception 'An error occurred while updating the entries. See the inner exception for details.'
2021-05-21 15:14:06.401 +03:00 [INF] "2021-05-21T12:14:05.5675953Z" FAILED executing command Cofoundry.Domain.AddCofoundryUserCommand. User 2, Exception 'An error occurred while updating the entries. See the inner exception for details.'
2021-05-21 15:14:06.825 +03:00 [INF] Executed action Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin) in 1362.3025ms
2021-05-21 15:14:06.827 +03:00 [INF] Executed endpoint 'Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin)'
2021-05-21 15:14:06.830 +03:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> System.Data.SqlClient.SqlException (0x80131904): Cannot insert duplicate key row in object 'Cofoundry.User' with unique index 'UIX_User_Email'. The duplicate key value is (<NULL>, 33@mail.com).
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__126_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:511f1f2d-835b-4fa0-9abf-49cd2fcc3687
Error Number:2601,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Cofoundry.Domain.Internal.AddUserCommandHandler.ExecuteAsync(AddUserCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\Domain\Users\Commands\AddUserCommandHandler.cs:line 64
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteCommandAsync[TCommand](TCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 130
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteCommandAsync[TCommand](TCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 135
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteAsync(ICommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 107
   at Cofoundry.Domain.Internal.AddCofoundryUserCommandHandler.ExecuteAsync(AddCofoundryUserCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\Domain\Users\Commands\AddCofoundryUserCommandHandler.cs:line 47
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteCommandAsync[TCommand](TCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 130
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteCommandAsync[TCommand](TCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 135
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteAsync(ICommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 107
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteAsync(ICommand command) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 89
   at Cofoundry.Web.ApiResponseHelper.RunCommandAsync[TCommand](TCommand command) in C:\work\Github\PlatformFramework\src\Cofoundry.Web\Framework\WebApi\ApiResponseHelpers\ApiResponseHelper.cs:line 154
   at Cofoundry.Web.Admin.UsersApiController.Add(AddUserCommand command) in C:\work\Github\PlatformFramework\src\Cofoundry.Web.Admin\Admin\Api\Users\UsersApiController.cs:line 60
   at lambda_method336(Closure , Object )
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.ResponseCompression.ResponseCompressionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2021-05-21 15:14:06.921 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/usersApi/add application/json 88 - 500 - text/plain 1469.8862ms
2021-05-21 15:14:53.455 +03:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/add - -
2021-05-21 15:14:53.458 +03:00 [INF] CORS policy execution successful.
2021-05-21 15:14:53.459 +03:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/add - - - 204 - - 4.1198ms
2021-05-21 15:14:53.489 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/usersApi/add application/json 88
2021-05-21 15:14:53.490 +03:00 [INF] CORS policy execution successful.
2021-05-21 15:14:53.490 +03:00 [INF] Authorization was successful.
2021-05-21 15:14:53.491 +03:00 [INF] Executing endpoint 'Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin)'
2021-05-21 15:14:53.492 +03:00 [INF] Route matched with {action = "Add", controller = "UsersApi"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.JsonResult] Add(Cofoundry.Domain.AddUserCommand) on controller Cofoundry.Web.Admin.UsersApiController (Dot.Web.Admin).
2021-05-21 15:14:53.515 +03:00 [INF] Executing action method Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin) - Validation state: "Valid"
2021-05-21 15:14:53.519 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-21 15:14:53.555 +03:00 [INF] Executed DbCommand (34ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE (([u].[UserId] = @__id_0) AND ([u].[IsDeleted] <> CAST(1 AS bit))) AND (([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit)))
2021-05-21 15:14:53.613 +03:00 [INF] Executed DbCommand (45ms) [Parameters=[@__query_Username_1='?' (Size = 150)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Cofoundry].[User] AS [u]
        WHERE ([u].[IsDeleted] <> CAST(1 AS bit)) AND ([u].[Username] = @__query_Username_1)) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-05-21 15:14:53.645 +03:00 [INF] Executed DbCommand (30ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[Role] AS [r]
WHERE [r].[RoleId] = @__id_0
2021-05-21 15:14:53.716 +03:00 [ERR] Failed executing DbCommand (34ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (Size = 150), @p3='?' (Size = 32), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTime2), @p8='?' (Size = 32), @p9='?' (DbType = DateTime2), @p10='?' (Size = 4000), @p11='?' (DbType = DateTime2), @p12='?' (DbType = Boolean), @p13='?' (DbType = Int32), @p14='?' (Size = 150)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Cofoundry].[User] ([CreateDate], [CreatorId], [Email], [FirstName], [IsDeleted], [IsEmailConfirmed], [IsSystemAccount], [LastLoginDate], [LastName], [LastPasswordChangeDate], [Password], [PreviousLoginDate], [RequirePasswordChange], [RoleId], [Username])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
SELECT [UserId]
FROM [Cofoundry].[User]
WHERE @@ROWCOUNT = 1 AND [UserId] = scope_identity();
2021-05-21 15:14:53.725 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'Cofoundry.Domain.Data.CofoundryDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> System.Data.SqlClient.SqlException (0x80131904): Cannot insert duplicate key row in object 'Cofoundry.User' with unique index 'UIX_User_Email'. The duplicate key value is (<NULL>, 33@mail.com).
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__126_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:511f1f2d-835b-4fa0-9abf-49cd2fcc3687
Error Number:2601,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> System.Data.SqlClient.SqlException (0x80131904): Cannot insert duplicate key row in object 'Cofoundry.User' with unique index 'UIX_User_Email'. The duplicate key value is (<NULL>, 33@mail.com).
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__126_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:511f1f2d-835b-4fa0-9abf-49cd2fcc3687
Error Number:2601,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2021-05-21 15:14:53.864 +03:00 [INF] "2021-05-21T12:14:53.5584216Z" FAILED executing command Cofoundry.Domain.AddUserCommand. User 2, Exception 'An error occurred while updating the entries. See the inner exception for details.'
2021-05-21 15:14:54.143 +03:00 [INF] "2021-05-21T12:14:53.5584216Z" FAILED executing command Cofoundry.Domain.AddCofoundryUserCommand. User 2, Exception 'An error occurred while updating the entries. See the inner exception for details.'
2021-05-21 15:14:54.555 +03:00 [INF] Executed action Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin) in 1061.8571ms
2021-05-21 15:14:54.557 +03:00 [INF] Executed endpoint 'Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin)'
2021-05-21 15:14:54.561 +03:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> System.Data.SqlClient.SqlException (0x80131904): Cannot insert duplicate key row in object 'Cofoundry.User' with unique index 'UIX_User_Email'. The duplicate key value is (<NULL>, 33@mail.com).
The statement has been terminated.
   at System.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__126_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:511f1f2d-835b-4fa0-9abf-49cd2fcc3687
Error Number:2601,State:1,Class:14
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Cofoundry.Domain.Internal.AddUserCommandHandler.ExecuteAsync(AddUserCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\Domain\Users\Commands\AddUserCommandHandler.cs:line 64
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteCommandAsync[TCommand](TCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 130
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteCommandAsync[TCommand](TCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 135
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteAsync(ICommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 107
   at Cofoundry.Domain.Internal.AddCofoundryUserCommandHandler.ExecuteAsync(AddCofoundryUserCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\Domain\Users\Commands\AddCofoundryUserCommandHandler.cs:line 47
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteCommandAsync[TCommand](TCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 130
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteCommandAsync[TCommand](TCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 135
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteAsync(ICommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 107
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteAsync(ICommand command) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 89
   at Cofoundry.Web.ApiResponseHelper.RunCommandAsync[TCommand](TCommand command) in C:\work\Github\PlatformFramework\src\Cofoundry.Web\Framework\WebApi\ApiResponseHelpers\ApiResponseHelper.cs:line 154
   at Cofoundry.Web.Admin.UsersApiController.Add(AddUserCommand command) in C:\work\Github\PlatformFramework\src\Cofoundry.Web.Admin\Admin\Api\Users\UsersApiController.cs:line 60
   at lambda_method336(Closure , Object )
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.ResponseCompression.ResponseCompressionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2021-05-21 15:14:54.586 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/usersApi/add application/json 88 - 500 - text/plain 1097.1924ms
2021-05-21 15:15:08.421 +03:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/add - -
2021-05-21 15:15:08.423 +03:00 [INF] CORS policy execution successful.
2021-05-21 15:15:08.424 +03:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/add - - - 204 - - 3.2620ms
2021-05-21 15:15:08.427 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/usersApi/add application/json 88
2021-05-21 15:15:08.429 +03:00 [INF] CORS policy execution successful.
2021-05-21 15:15:08.431 +03:00 [INF] Authorization was successful.
2021-05-21 15:15:08.431 +03:00 [INF] Executing endpoint 'Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin)'
2021-05-21 15:15:08.432 +03:00 [INF] Route matched with {action = "Add", controller = "UsersApi"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.JsonResult] Add(Cofoundry.Domain.AddUserCommand) on controller Cofoundry.Web.Admin.UsersApiController (Dot.Web.Admin).
2021-05-21 15:15:08.451 +03:00 [INF] Executing action method Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin) - Validation state: "Valid"
2021-05-21 15:15:08.452 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-21 15:15:08.487 +03:00 [INF] Executed DbCommand (34ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE (([u].[UserId] = @__id_0) AND ([u].[IsDeleted] <> CAST(1 AS bit))) AND (([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit)))
2021-05-21 15:15:08.538 +03:00 [INF] Executed DbCommand (45ms) [Parameters=[@__query_Username_1='?' (Size = 150)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Cofoundry].[User] AS [u]
        WHERE ([u].[IsDeleted] <> CAST(1 AS bit)) AND ([u].[Username] = @__query_Username_1)) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-05-21 15:15:08.576 +03:00 [INF] Executed DbCommand (33ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[Role] AS [r]
WHERE [r].[RoleId] = @__id_0
2021-05-21 15:15:08.646 +03:00 [INF] Executed DbCommand (32ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (Size = 150), @p3='?' (Size = 32), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTime2), @p8='?' (Size = 32), @p9='?' (DbType = DateTime2), @p10='?' (Size = 4000), @p11='?' (DbType = DateTime2), @p12='?' (DbType = Boolean), @p13='?' (DbType = Int32), @p14='?' (Size = 150)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Cofoundry].[User] ([CreateDate], [CreatorId], [Email], [FirstName], [IsDeleted], [IsEmailConfirmed], [IsSystemAccount], [LastLoginDate], [LastName], [LastPasswordChangeDate], [Password], [PreviousLoginDate], [RequirePasswordChange], [RoleId], [Username])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
SELECT [UserId]
FROM [Cofoundry].[User]
WHERE @@ROWCOUNT = 1 AND [UserId] = scope_identity();
2021-05-21 15:15:08.679 +03:00 [INF] "2021-05-21T12:15:08.4902366Z" SUCCESS executing command Cofoundry.Domain.AddUserCommand. User 2
2021-05-21 15:15:08.743 +03:00 [INF] Executed DbCommand (54ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[SettingId], [s].[CreateDate], [s].[SettingKey], [s].[SettingValue], [s].[UpdateDate]
FROM [Cofoundry].[Setting] AS [s]
2021-05-21 15:15:09.119 +03:00 [INF] "2021-05-21T12:15:08.4902366Z" FAILED executing command Cofoundry.Domain.AddCofoundryUserCommand. User 2, Exception 'Error rendering mail template'
2021-05-21 15:15:09.370 +03:00 [INF] Executed action Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin) in 936.9441ms
2021-05-21 15:15:09.372 +03:00 [INF] Executed endpoint 'Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin)'
2021-05-21 15:15:09.374 +03:00 [ERR] An unhandled exception has occurred while executing the request.
Cofoundry.Core.Mail.TemplateRenderException: Error rendering mail template
 ---> System.InvalidOperationException: Couldn't find mail template '~/MailTemplates/AdminMailTemplates/Users/NewUserWelcomeMail_text.cshtml'
   at Cofoundry.Core.Mail.Internal.RazorMailViewRenderer.RenderAsync[TModel](String viewPath, TModel model) in C:\work\Github\PlatformFramework\src\Cofoundry.Core\Mail\Rendering\RazorMailViewRenderer.cs:line 61
   at Cofoundry.Core.Mail.Internal.MailMessageRenderer.RenderViewAsync(IMailTemplate template, String type) in C:\work\Github\PlatformFramework\src\Cofoundry.Core\Mail\Rendering\MailMessageRenderer.cs:line 60
   --- End of inner exception stack trace ---
   at Cofoundry.Core.Mail.Internal.MailMessageRenderer.RenderViewAsync(IMailTemplate template, String type) in C:\work\Github\PlatformFramework\src\Cofoundry.Core\Mail\Rendering\MailMessageRenderer.cs:line 64
   at Cofoundry.Core.Mail.Internal.MailMessageRenderer.RenderAsync(IMailTemplate template, MailAddress toAddress) in C:\work\Github\PlatformFramework\src\Cofoundry.Core\Mail\Rendering\MailMessageRenderer.cs:line 39
   at Cofoundry.Core.Mail.Internal.SimpleMailService.SendAsync(String toEmail, String toDisplayName, IMailTemplate template) in C:\work\Github\PlatformFramework\src\Cofoundry.Core\Mail\Services\SimpleMailService.cs:line 36
   at Cofoundry.Domain.Internal.AddCofoundryUserCommandHandler.ExecuteAsync(AddCofoundryUserCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\Domain\Users\Commands\AddCofoundryUserCommandHandler.cs:line 52
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteCommandAsync[TCommand](TCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 130
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteCommandAsync[TCommand](TCommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 135
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteAsync(ICommand command, IExecutionContext executionContext) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 107
   at Cofoundry.Domain.CQS.Internal.CommandExecutor.ExecuteAsync(ICommand command) in C:\work\Github\PlatformFramework\src\Cofoundry.Domain\CQS\Framework\Command\CommandExecutor.cs:line 89
   at Cofoundry.Web.ApiResponseHelper.RunCommandAsync[TCommand](TCommand command) in C:\work\Github\PlatformFramework\src\Cofoundry.Web\Framework\WebApi\ApiResponseHelpers\ApiResponseHelper.cs:line 154
   at Cofoundry.Web.Admin.UsersApiController.Add(AddUserCommand command) in C:\work\Github\PlatformFramework\src\Cofoundry.Web.Admin\Admin\Api\Users\UsersApiController.cs:line 60
   at lambda_method336(Closure , Object )
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Logged|12_1(ControllerActionInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|24_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.Policy.AuthorizationMiddlewareResultHandler.HandleAsync(RequestDelegate next, HttpContext context, AuthorizationPolicy policy, PolicyAuthorizationResult authorizeResult)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.ResponseCompression.ResponseCompressionMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2021-05-21 15:15:09.404 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/usersApi/add application/json 88 - 500 - text/plain 976.8710ms
2021-05-21 15:17:19.768 +03:00 [INF] User profile is available. Using 'C:\Users\Max\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2021-05-21 15:17:19.944 +03:00 [INF] Starting service
2021-05-21 15:17:20.923 +03:00 [INF] Now listening on: http://localhost:5000
2021-05-21 15:17:20.924 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2021-05-21 15:17:20.924 +03:00 [INF] Hosting environment: Development
2021-05-21 15:17:20.933 +03:00 [INF] Content root path: C:\work\Github\PlatformFramework\samples\Web.Service.Identity
2021-05-21 15:17:22.653 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-21 15:17:23.386 +03:00 [INF] Executed DbCommand (100ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE ([u].[IsDeleted] <> CAST(1 AS bit)) AND ([u].[IsSystemAccount] = CAST(1 AS bit))
2021-05-21 15:17:23.866 +03:00 [INF] Executed DbCommand (119ms) [Parameters=[@__roleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[RoleId], [t].[RoleCode], [t].[Title], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0], [t0].[EntityDefinitionCode], [t0].[PermissionCode]
FROM (
    SELECT TOP(1) [r].[RoleId], [r].[RoleCode], [r].[Title]
    FROM [Cofoundry].[Role] AS [r]
    WHERE [r].[RoleId] = @__roleId_0
) AS [t]
LEFT JOIN (
    SELECT [r0].[RoleId], [r0].[PermissionId], [p].[PermissionId] AS [PermissionId0], [p].[EntityDefinitionCode], [p].[PermissionCode]
    FROM [Cofoundry].[RolePermission] AS [r0]
    INNER JOIN [Cofoundry].[Permission] AS [p] ON [r0].[PermissionId] = [p].[PermissionId]
) AS [t0] ON [t].[RoleId] = [t0].[RoleId]
ORDER BY [t].[RoleId], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0]
2021-05-21 15:17:23.972 +03:00 [INF] Executed DbCommand (66ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [e].[EntityDefinitionCode], [e].[Name]
FROM [Cofoundry].[EntityDefinition] AS [e]
2021-05-21 15:17:24.038 +03:00 [INF] Executed DbCommand (39ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[PermissionId], [p].[EntityDefinitionCode], [p].[PermissionCode]
FROM [Cofoundry].[Permission] AS [p]
2021-05-21 15:17:24.121 +03:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[RoleId], [r].[RoleCode], [r].[Title], [t].[RoleId], [t].[PermissionId], [t].[PermissionId0], [t].[EntityDefinitionCode], [t].[PermissionCode]
FROM [Cofoundry].[Role] AS [r]
LEFT JOIN (
    SELECT [r0].[RoleId], [r0].[PermissionId], [p].[PermissionId] AS [PermissionId0], [p].[EntityDefinitionCode], [p].[PermissionCode]
    FROM [Cofoundry].[RolePermission] AS [r0]
    INNER JOIN [Cofoundry].[Permission] AS [p] ON [r0].[PermissionId] = [p].[PermissionId]
) AS [t] ON [r].[RoleId] = [t].[RoleId]
ORDER BY [r].[RoleId], [t].[RoleId], [t].[PermissionId], [t].[PermissionId0]
2021-05-21 15:17:24.196 +03:00 [INF] "2021-05-21T12:17:23.5830181Z" SUCCESS executing command Cofoundry.Domain.RegisterPermissionsAndRolesCommand. User 1
2021-05-21 15:17:24.249 +03:00 [INF] Process completed
2021-05-21 15:17:28.095 +03:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/add - -
2021-05-21 15:17:28.102 +03:00 [INF] CORS policy execution successful.
2021-05-21 15:17:28.116 +03:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/add - - - 204 - - 23.2202ms
2021-05-21 15:17:28.128 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/usersApi/add application/json 88
2021-05-21 15:17:28.131 +03:00 [INF] CORS policy execution successful.
2021-05-21 15:17:28.200 +03:00 [INF] Authorization was successful.
2021-05-21 15:17:28.202 +03:00 [INF] Executing endpoint 'Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin)'
2021-05-21 15:17:28.230 +03:00 [INF] Route matched with {action = "Add", controller = "UsersApi"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.JsonResult] Add(Cofoundry.Domain.AddUserCommand) on controller Cofoundry.Web.Admin.UsersApiController (Dot.Web.Admin).
2021-05-21 15:17:28.352 +03:00 [INF] Executing action method Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin) - Validation state: "Valid"
2021-05-21 15:17:28.386 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-21 15:17:28.454 +03:00 [INF] Executed DbCommand (61ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE (([u].[UserId] = @__id_0) AND ([u].[IsDeleted] <> CAST(1 AS bit))) AND (([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit)))
2021-05-21 15:17:28.522 +03:00 [INF] Executed DbCommand (41ms) [Parameters=[@__roleId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[RoleId], [t].[RoleCode], [t].[Title], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0], [t0].[EntityDefinitionCode], [t0].[PermissionCode]
FROM (
    SELECT TOP(1) [r].[RoleId], [r].[RoleCode], [r].[Title]
    FROM [Cofoundry].[Role] AS [r]
    WHERE [r].[RoleId] = @__roleId_0
) AS [t]
LEFT JOIN (
    SELECT [r0].[RoleId], [r0].[PermissionId], [p].[PermissionId] AS [PermissionId0], [p].[EntityDefinitionCode], [p].[PermissionCode]
    FROM [Cofoundry].[RolePermission] AS [r0]
    INNER JOIN [Cofoundry].[Permission] AS [p] ON [r0].[PermissionId] = [p].[PermissionId]
) AS [t0] ON [t].[RoleId] = [t0].[RoleId]
ORDER BY [t].[RoleId], [t0].[RoleId], [t0].[PermissionId], [t0].[PermissionId0]
2021-05-21 15:17:28.611 +03:00 [INF] Executed DbCommand (62ms) [Parameters=[@__query_Username_1='?' (Size = 150)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Cofoundry].[User] AS [u]
        WHERE ([u].[IsDeleted] <> CAST(1 AS bit)) AND ([u].[Username] = @__query_Username_1)) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2021-05-21 15:17:28.668 +03:00 [INF] Executed DbCommand (44ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[Role] AS [r]
WHERE [r].[RoleId] = @__id_0
2021-05-21 15:17:28.844 +03:00 [INF] Executed DbCommand (47ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (Size = 150), @p3='?' (Size = 32), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTime2), @p8='?' (Size = 32), @p9='?' (DbType = DateTime2), @p10='?' (Size = 4000), @p11='?' (DbType = DateTime2), @p12='?' (DbType = Boolean), @p13='?' (DbType = Int32), @p14='?' (Size = 150)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Cofoundry].[User] ([CreateDate], [CreatorId], [Email], [FirstName], [IsDeleted], [IsEmailConfirmed], [IsSystemAccount], [LastLoginDate], [LastName], [LastPasswordChangeDate], [Password], [PreviousLoginDate], [RequirePasswordChange], [RoleId], [Username])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
SELECT [UserId]
FROM [Cofoundry].[User]
WHERE @@ROWCOUNT = 1 AND [UserId] = scope_identity();
2021-05-21 15:17:28.890 +03:00 [INF] "2021-05-21T12:17:28.4603158Z" SUCCESS executing command Cofoundry.Domain.AddUserCommand. User 2
2021-05-21 15:17:28.971 +03:00 [INF] Executed DbCommand (69ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[SettingId], [s].[CreateDate], [s].[SettingKey], [s].[SettingValue], [s].[UpdateDate]
FROM [Cofoundry].[Setting] AS [s]
2021-05-21 15:17:29.016 +03:00 [INF] "2021-05-21T12:17:28.4603158Z" SUCCESS executing command Cofoundry.Domain.AddCofoundryUserCommand. User 2
2021-05-21 15:17:29.025 +03:00 [INF] Executed action method Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin), returned result Microsoft.AspNetCore.Mvc.JsonResult in 667.5294ms.
2021-05-21 15:17:29.029 +03:00 [INF] Executing JsonResult, writing value of type 'Cofoundry.Web.SimpleCommandResponseData`1[[System.Object, System.Private.CoreLib, Version=5.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2021-05-21 15:17:29.069 +03:00 [INF] Executed action Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin) in 827.2927ms
2021-05-21 15:17:29.075 +03:00 [INF] Executed endpoint 'Cofoundry.Web.Admin.UsersApiController.Add (Dot.Web.Admin)'
2021-05-21 15:17:29.080 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/usersApi/add application/json 88 - 200 - application/json;+charset=utf-8 952.3299ms
2021-05-21 15:17:32.244 +03:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/getAll - -
2021-05-21 15:17:32.246 +03:00 [INF] CORS policy execution successful.
2021-05-21 15:17:32.246 +03:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5000/api/usersApi/getAll - - - 204 - - 2.0164ms
2021-05-21 15:17:32.255 +03:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/usersApi/getAll application/json 31
2021-05-21 15:17:32.256 +03:00 [INF] CORS policy execution successful.
2021-05-21 15:17:32.259 +03:00 [INF] Authorization was successful.
2021-05-21 15:17:32.259 +03:00 [INF] Executing endpoint 'Cofoundry.Web.Admin.UsersApiController.GetAll (Dot.Web.Admin)'
2021-05-21 15:17:32.263 +03:00 [INF] Route matched with {action = "GetAll", controller = "UsersApi"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.JsonResult] GetAll(Cofoundry.Domain.SearchUserSummariesQuery) on controller Cofoundry.Web.Admin.UsersApiController (Dot.Web.Admin).
2021-05-21 15:17:32.294 +03:00 [INF] Executing action method Cofoundry.Web.Admin.UsersApiController.GetAll (Dot.Web.Admin) - Validation state: "Valid"
2021-05-21 15:17:32.308 +03:00 [INF] Entity Framework Core 5.0.6 initialized 'CofoundryDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2021-05-21 15:17:32.356 +03:00 [INF] Executed DbCommand (45ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM [Cofoundry].[User] AS [u]
INNER JOIN [Cofoundry].[Role] AS [r] ON [u].[RoleId] = [r].[RoleId]
WHERE (([u].[UserId] = @__id_0) AND ([u].[IsDeleted] <> CAST(1 AS bit))) AND (([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit)))
2021-05-21 15:17:32.445 +03:00 [INF] Executed DbCommand (58ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Cofoundry].[User] AS [u]
WHERE ([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit))
2021-05-21 15:17:32.494 +03:00 [INF] Executed DbCommand (36ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[UserId], [t].[CreateDate], [t].[CreatorId], [t].[Email], [t].[FirstName], [t].[IsDeleted], [t].[IsEmailConfirmed], [t].[IsSystemAccount], [t].[LastLoginDate], [t].[LastName], [t].[LastPasswordChangeDate], [t].[Password], [t].[PreviousLoginDate], [t].[RequirePasswordChange], [t].[RoleId], [t].[Username], [r].[RoleId], [r].[RoleCode], [r].[Title]
FROM (
    SELECT [u].[UserId], [u].[CreateDate], [u].[CreatorId], [u].[Email], [u].[FirstName], [u].[IsDeleted], [u].[IsEmailConfirmed], [u].[IsSystemAccount], [u].[LastLoginDate], [u].[LastName], [u].[LastPasswordChangeDate], [u].[Password], [u].[PreviousLoginDate], [u].[RequirePasswordChange], [u].[RoleId], [u].[Username]
    FROM [Cofoundry].[User] AS [u]
    WHERE ([u].[IsSystemAccount] <> CAST(1 AS bit)) AND ([u].[IsDeleted] <> CAST(1 AS bit))
    ORDER BY [u].[LastName]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [t]
INNER JOIN [Cofoundry].[Role] AS [r] ON [t].[RoleId] = [r].[RoleId]
ORDER BY [t].[LastName]
2021-05-21 15:17:32.502 +03:00 [INF] Executed action method Cofoundry.Web.Admin.UsersApiController.GetAll (Dot.Web.Admin), returned result Microsoft.AspNetCore.Mvc.JsonResult in 202.6092ms.
2021-05-21 15:17:32.506 +03:00 [INF] Executing JsonResult, writing value of type 'Cofoundry.Domain.PagedQueryResult`1[[Cofoundry.Domain.UserSummary, Dot.Domain, Version=0.7.0.0, Culture=neutral, PublicKeyToken=null]]'.
2021-05-21 15:17:32.519 +03:00 [INF] Executed action Cofoundry.Web.Admin.UsersApiController.GetAll (Dot.Web.Admin) in 254.4996ms
2021-05-21 15:17:32.519 +03:00 [INF] Executed endpoint 'Cofoundry.Web.Admin.UsersApiController.GetAll (Dot.Web.Admin)'
2021-05-21 15:17:32.520 +03:00 [INF] Request finished HTTP/1.1 POST http://localhost:5000/api/usersApi/getAll application/json 31 - 200 - application/json;+charset=utf-8 265.5222ms
